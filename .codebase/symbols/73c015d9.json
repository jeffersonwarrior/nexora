{
  "file_path": "/work/.github/workflows/request-ai-fix.yml",
  "file_hash": "6553f54fb901b67bd5273907aed903e6c35c35b4",
  "updated_at": "2025-12-26T17:34:23.906915",
  "symbols": {
    "key_name_1": {
      "name": "name",
      "type": "key",
      "start_line": 1,
      "end_line": 1,
      "content_hash": "61f5d5a40e0191cbd04b179da1edb9df1d20bbb4",
      "content": "name: Request AI Fix for CI Failures",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on_3": {
      "name": "on",
      "type": "key",
      "start_line": 3,
      "end_line": 13,
      "content_hash": "4c8a5b2a1f604af60302fcd8a8fccc9a4efd1baa",
      "content": "on:\n  workflow_run:\n    workflows: [\"lint\", \"build\"]  # Trigger after these workflows\n    types:\n      - completed\n  workflow_dispatch:\n    inputs:\n      issue_url:\n        description: 'Issue URL to analyze'\n        required: false\n        type: string",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_run_4": {
      "name": "on.workflow_run",
      "type": "key",
      "start_line": 4,
      "end_line": 7,
      "content_hash": "77464cc52a663fde91535da337c88e5d8ce7e9f4",
      "content": "  workflow_run:\n    workflows: [\"lint\", \"build\"]  # Trigger after these workflows\n    types:\n      - completed",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_run.workflows_5": {
      "name": "on.workflow_run.workflows",
      "type": "key",
      "start_line": 5,
      "end_line": 5,
      "content_hash": "59f5cecebea656e4cbbf8acece5400811723ece4",
      "content": "    workflows: [\"lint\", \"build\"]  # Trigger after these workflows",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_run.types_6": {
      "name": "on.workflow_run.types",
      "type": "key",
      "start_line": 6,
      "end_line": 7,
      "content_hash": "f605f479922d57a8e37ee5bc3c027cfbf069b23f",
      "content": "    types:\n      - completed",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch_8": {
      "name": "on.workflow_dispatch",
      "type": "key",
      "start_line": 8,
      "end_line": 13,
      "content_hash": "c659ad55cb7ab3c45e6a4f4d0550527bf0cbeb42",
      "content": "  workflow_dispatch:\n    inputs:\n      issue_url:\n        description: 'Issue URL to analyze'\n        required: false\n        type: string",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch.inputs_9": {
      "name": "on.workflow_dispatch.inputs",
      "type": "key",
      "start_line": 9,
      "end_line": 13,
      "content_hash": "85eaee59151df397d2cdb7db7670fbcfa4f24767",
      "content": "    inputs:\n      issue_url:\n        description: 'Issue URL to analyze'\n        required: false\n        type: string",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch.inputs.issue_url_10": {
      "name": "on.workflow_dispatch.inputs.issue_url",
      "type": "key",
      "start_line": 10,
      "end_line": 13,
      "content_hash": "af887e13bdb49ed36b204230d3ce0e84b6c75d6a",
      "content": "      issue_url:\n        description: 'Issue URL to analyze'\n        required: false\n        type: string",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch.inputs.issue_url.description_11": {
      "name": "on.workflow_dispatch.inputs.issue_url.description",
      "type": "key",
      "start_line": 11,
      "end_line": 11,
      "content_hash": "eaa131c083d09fec2ad005edf2f0ee0a27da770b",
      "content": "        description: 'Issue URL to analyze'",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch.inputs.issue_url.required_12": {
      "name": "on.workflow_dispatch.inputs.issue_url.required",
      "type": "key",
      "start_line": 12,
      "end_line": 12,
      "content_hash": "67df8fae41b9681b1abadbc20164aed4bf30a37c",
      "content": "        required: false",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch.inputs.issue_url.type_13": {
      "name": "on.workflow_dispatch.inputs.issue_url.type",
      "type": "key",
      "start_line": 13,
      "end_line": 13,
      "content_hash": "b0bac83ceed8ab6f1b55b51d2ff561328d526651",
      "content": "        type: string",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_permissions_15": {
      "name": "permissions",
      "type": "key",
      "start_line": 15,
      "end_line": 18,
      "content_hash": "07bcd0caf0431a9a018aa598fce3f0786afa53d2",
      "content": "permissions:\n  contents: read\n  issues: write\n  pull-requests: write",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_permissions.contents_16": {
      "name": "permissions.contents",
      "type": "key",
      "start_line": 16,
      "end_line": 16,
      "content_hash": "11a0af2662fcadc8d3459283e8faa75e041a1df3",
      "content": "  contents: read",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_permissions.issues_17": {
      "name": "permissions.issues",
      "type": "key",
      "start_line": 17,
      "end_line": 17,
      "content_hash": "031bf5f315b87b4590942c80893b25ff4def832e",
      "content": "  issues: write",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_permissions.pull-requests_18": {
      "name": "permissions.pull-requests",
      "type": "key",
      "start_line": 18,
      "end_line": 18,
      "content_hash": "80329738cc990f1860d013ef6bf3fbf91304666c",
      "content": "  pull-requests: write",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs_20": {
      "name": "jobs",
      "type": "key",
      "start_line": 20,
      "end_line": 70,
      "content_hash": "903b9acb4f0fb75ca9b2f1fff6ca373cd9f033e4",
      "content": "jobs:\n  request-ai-fix:\n    runs-on: ubuntu-latest\n    if: ${{ github.event.workflow_run.conclusion == 'failure' || github.event_name == 'workflow_dispatch' }}\n    \n    steps:\n      - name: Request AI Fix via API\n        run: |\n          # Extract information from the failed workflow\n          WORKFLOW_URL=\"${{ github.event.workflow_run.html_url || github.event.repository.html_url }}\"\n          ISSUE_URL=\"${{ github.event.inputs.issue_url || '' }}\"\n          \n          # Prepare the request payload\n          cat > fix-request.json << EOF\n          {\n            \"model\": \"zai-glm-4.6\",\n            \"provider\": \"cerebras\",\n            \"messages\": [\n              {\n                \"role\": \"system\",\n                \"content\": \"You are an AI assistant helping to fix CI failures in the Nexora project. Analyze the provided failure information and generate a patch or detailed fix instructions.\"\n              },\n              {\n                \"role\": \"user\",\n                \"content\": \"CI workflow failed. Please analyze and provide a fix.\\n\\nRepository: ${{ github.repository }}\\nWorkflow URL: $WORKFLOW_URL\\nIssue URL: $ISSUE_URL\\n\\nBranch: ${{ github.ref_name }}\\nCommit: ${{ github.sha }}\\n\\nPlease:\\n1. Identify the root cause of the failure\\n2. Provide specific code fixes or patches\\n3. Explain what went wrong\\n4. Suggest how to prevent similar issues\"\n              }\n            ],\n            \"max_tokens\": 4000,\n            \"temperature\": 0.1\n          }\n          EOF\n          \n          echo \"\ud83e\udd16 Requesting AI fix for CI failure...\"\n          echo \"Workflow: $WORKFLOW_URL\"\n          echo \"Issue: $ISSUE_URL\"\n          \n          # Call the AI API\n          curl -s -X POST \\\n            -H \"Content-Type: application/json\" \\\n            -H \"Authorization: Bearer $AI_API_KEY\" \\\n            -d @fix-request.json \\\n            \"$AI_API_ENDPOINT\" > ai-response.json\n          \n          # Extract the AI response\n          AI_RESPONSE=$(cat ai-response.json | jq -r '.choices[0].message.content // \"No response received\"')\n          \n          # Create or update an issue with the AI response\n          if [[ -n \"$ISSUE_URL\" ]]; then\n            # Comment on existing issue\n            ISSUE_NUMBER=$(echo \"$ISSUE_URL\" | sed -n 's/.*\\/issues\\/\\([0-9]*\\).*/\\1/p')\n            gh issue comment \"$ISSUE_NUMBER\" --body \"## \ud83e\udd16 AI Analysis and Fix",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix_21": {
      "name": "jobs.request-ai-fix",
      "type": "key",
      "start_line": 21,
      "end_line": 70,
      "content_hash": "4b827a563ca9905a8ba69371ee9472444a2712a5",
      "content": "  request-ai-fix:\n    runs-on: ubuntu-latest\n    if: ${{ github.event.workflow_run.conclusion == 'failure' || github.event_name == 'workflow_dispatch' }}\n    \n    steps:\n      - name: Request AI Fix via API\n        run: |\n          # Extract information from the failed workflow\n          WORKFLOW_URL=\"${{ github.event.workflow_run.html_url || github.event.repository.html_url }}\"\n          ISSUE_URL=\"${{ github.event.inputs.issue_url || '' }}\"\n          \n          # Prepare the request payload\n          cat > fix-request.json << EOF\n          {\n            \"model\": \"zai-glm-4.6\",\n            \"provider\": \"cerebras\",\n            \"messages\": [\n              {\n                \"role\": \"system\",\n                \"content\": \"You are an AI assistant helping to fix CI failures in the Nexora project. Analyze the provided failure information and generate a patch or detailed fix instructions.\"\n              },\n              {\n                \"role\": \"user\",\n                \"content\": \"CI workflow failed. Please analyze and provide a fix.\\n\\nRepository: ${{ github.repository }}\\nWorkflow URL: $WORKFLOW_URL\\nIssue URL: $ISSUE_URL\\n\\nBranch: ${{ github.ref_name }}\\nCommit: ${{ github.sha }}\\n\\nPlease:\\n1. Identify the root cause of the failure\\n2. Provide specific code fixes or patches\\n3. Explain what went wrong\\n4. Suggest how to prevent similar issues\"\n              }\n            ],\n            \"max_tokens\": 4000,\n            \"temperature\": 0.1\n          }\n          EOF\n          \n          echo \"\ud83e\udd16 Requesting AI fix for CI failure...\"\n          echo \"Workflow: $WORKFLOW_URL\"\n          echo \"Issue: $ISSUE_URL\"\n          \n          # Call the AI API\n          curl -s -X POST \\\n            -H \"Content-Type: application/json\" \\\n            -H \"Authorization: Bearer $AI_API_KEY\" \\\n            -d @fix-request.json \\\n            \"$AI_API_ENDPOINT\" > ai-response.json\n          \n          # Extract the AI response\n          AI_RESPONSE=$(cat ai-response.json | jq -r '.choices[0].message.content // \"No response received\"')\n          \n          # Create or update an issue with the AI response\n          if [[ -n \"$ISSUE_URL\" ]]; then\n            # Comment on existing issue\n            ISSUE_NUMBER=$(echo \"$ISSUE_URL\" | sed -n 's/.*\\/issues\\/\\([0-9]*\\).*/\\1/p')\n            gh issue comment \"$ISSUE_NUMBER\" --body \"## \ud83e\udd16 AI Analysis and Fix",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix.runs-on_22": {
      "name": "jobs.request-ai-fix.runs-on",
      "type": "key",
      "start_line": 22,
      "end_line": 22,
      "content_hash": "af41e65e8de6d5fac9a3ffe97c9153f19e320298",
      "content": "    runs-on: ubuntu-latest",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix.if_23": {
      "name": "jobs.request-ai-fix.if",
      "type": "key",
      "start_line": 23,
      "end_line": 23,
      "content_hash": "6cb3336a5f4b9bc5909811feab52a03f50f3c762",
      "content": "    if: ${{ github.event.workflow_run.conclusion == 'failure' || github.event_name == 'workflow_dispatch' }}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix.steps_25": {
      "name": "jobs.request-ai-fix.steps",
      "type": "key",
      "start_line": 25,
      "end_line": 70,
      "content_hash": "eb55f0f73023c213f109f628c460cddf3f5109bf",
      "content": "    steps:\n      - name: Request AI Fix via API\n        run: |\n          # Extract information from the failed workflow\n          WORKFLOW_URL=\"${{ github.event.workflow_run.html_url || github.event.repository.html_url }}\"\n          ISSUE_URL=\"${{ github.event.inputs.issue_url || '' }}\"\n          \n          # Prepare the request payload\n          cat > fix-request.json << EOF\n          {\n            \"model\": \"zai-glm-4.6\",\n            \"provider\": \"cerebras\",\n            \"messages\": [\n              {\n                \"role\": \"system\",\n                \"content\": \"You are an AI assistant helping to fix CI failures in the Nexora project. Analyze the provided failure information and generate a patch or detailed fix instructions.\"\n              },\n              {\n                \"role\": \"user\",\n                \"content\": \"CI workflow failed. Please analyze and provide a fix.\\n\\nRepository: ${{ github.repository }}\\nWorkflow URL: $WORKFLOW_URL\\nIssue URL: $ISSUE_URL\\n\\nBranch: ${{ github.ref_name }}\\nCommit: ${{ github.sha }}\\n\\nPlease:\\n1. Identify the root cause of the failure\\n2. Provide specific code fixes or patches\\n3. Explain what went wrong\\n4. Suggest how to prevent similar issues\"\n              }\n            ],\n            \"max_tokens\": 4000,\n            \"temperature\": 0.1\n          }\n          EOF\n          \n          echo \"\ud83e\udd16 Requesting AI fix for CI failure...\"\n          echo \"Workflow: $WORKFLOW_URL\"\n          echo \"Issue: $ISSUE_URL\"\n          \n          # Call the AI API\n          curl -s -X POST \\\n            -H \"Content-Type: application/json\" \\\n            -H \"Authorization: Bearer $AI_API_KEY\" \\\n            -d @fix-request.json \\\n            \"$AI_API_ENDPOINT\" > ai-response.json\n          \n          # Extract the AI response\n          AI_RESPONSE=$(cat ai-response.json | jq -r '.choices[0].message.content // \"No response received\"')\n          \n          # Create or update an issue with the AI response\n          if [[ -n \"$ISSUE_URL\" ]]; then\n            # Comment on existing issue\n            ISSUE_NUMBER=$(echo \"$ISSUE_URL\" | sed -n 's/.*\\/issues\\/\\([0-9]*\\).*/\\1/p')\n            gh issue comment \"$ISSUE_NUMBER\" --body \"## \ud83e\udd16 AI Analysis and Fix",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix.steps.name_26": {
      "name": "jobs.request-ai-fix.steps.name",
      "type": "key",
      "start_line": 26,
      "end_line": 26,
      "content_hash": "258ca11e7bbf21b27eb18a2bd9089f4ef535d939",
      "content": "      - name: Request AI Fix via API",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.request-ai-fix.steps.run_27": {
      "name": "jobs.request-ai-fix.steps.run",
      "type": "key",
      "start_line": 27,
      "end_line": 70,
      "content_hash": "927e1a73785e0e843ccb9d7ea8b6fd75bf9fc73c",
      "content": "        run: |\n          # Extract information from the failed workflow\n          WORKFLOW_URL=\"${{ github.event.workflow_run.html_url || github.event.repository.html_url }}\"\n          ISSUE_URL=\"${{ github.event.inputs.issue_url || '' }}\"\n          \n          # Prepare the request payload\n          cat > fix-request.json << EOF\n          {\n            \"model\": \"zai-glm-4.6\",\n            \"provider\": \"cerebras\",\n            \"messages\": [\n              {\n                \"role\": \"system\",\n                \"content\": \"You are an AI assistant helping to fix CI failures in the Nexora project. Analyze the provided failure information and generate a patch or detailed fix instructions.\"\n              },\n              {\n                \"role\": \"user\",\n                \"content\": \"CI workflow failed. Please analyze and provide a fix.\\n\\nRepository: ${{ github.repository }}\\nWorkflow URL: $WORKFLOW_URL\\nIssue URL: $ISSUE_URL\\n\\nBranch: ${{ github.ref_name }}\\nCommit: ${{ github.sha }}\\n\\nPlease:\\n1. Identify the root cause of the failure\\n2. Provide specific code fixes or patches\\n3. Explain what went wrong\\n4. Suggest how to prevent similar issues\"\n              }\n            ],\n            \"max_tokens\": 4000,\n            \"temperature\": 0.1\n          }\n          EOF\n          \n          echo \"\ud83e\udd16 Requesting AI fix for CI failure...\"\n          echo \"Workflow: $WORKFLOW_URL\"\n          echo \"Issue: $ISSUE_URL\"\n          \n          # Call the AI API\n          curl -s -X POST \\\n            -H \"Content-Type: application/json\" \\\n            -H \"Authorization: Bearer $AI_API_KEY\" \\\n            -d @fix-request.json \\\n            \"$AI_API_ENDPOINT\" > ai-response.json\n          \n          # Extract the AI response\n          AI_RESPONSE=$(cat ai-response.json | jq -r '.choices[0].message.content // \"No response received\"')\n          \n          # Create or update an issue with the AI response\n          if [[ -n \"$ISSUE_URL\" ]]; then\n            # Comment on existing issue\n            ISSUE_NUMBER=$(echo \"$ISSUE_URL\" | sed -n 's/.*\\/issues\\/\\([0-9]*\\).*/\\1/p')\n            gh issue comment \"$ISSUE_NUMBER\" --body \"## \ud83e\udd16 AI Analysis and Fix",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}