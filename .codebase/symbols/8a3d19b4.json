{
  "file_path": "/work/internal/tui/components/aiops/aiops.go",
  "file_hash": "20be514616c3b1987e087e6bf3dfd558ca24dda0",
  "updated_at": "2025-12-26T17:34:23.608464",
  "symbols": {
    "struct_RenderOptions_15": {
      "name": "RenderOptions",
      "type": "struct",
      "start_line": 15,
      "end_line": 24,
      "content_hash": "38b9f1c506663a6a0acf36802e735b70e6477f2f",
      "content": "type RenderOptions struct {\n\tMaxWidth    int\n\tMaxHeight   int\n\tCompact     bool\n\tShowDetails bool\n\tShowSection bool\n\tSectionName string\n}\n\n// AIOPSStatus represents the current AIOPS operational state.",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_AIOPSStatus_25": {
      "name": "AIOPSStatus",
      "type": "struct",
      "start_line": 25,
      "end_line": 33,
      "content_hash": "dfb519da641d1a0a25cf2dc9a2a8879e7072ffe1",
      "content": "type AIOPSStatus struct {\n\tModelInfo      aiops.ModelInfo\n\tRecentMetrics  Metrics\n\tDetectionState DetectionState\n\tLastAlert      *Alert\n\tIsConnected    bool\n\tUptime         time.Duration\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_Metrics_34": {
      "name": "Metrics",
      "type": "struct",
      "start_line": 34,
      "end_line": 41,
      "content_hash": "200ab11b07a1f27837e3180e23db6d6ab1b18470",
      "content": "type Metrics struct {\n\tEditResolutions int\n\tAvgConfidence   float64\n\tLoopChecks      int\n\tDriftScore      float64\n\tLastUpdate      time.Time\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_DetectionState_42": {
      "name": "DetectionState",
      "type": "struct",
      "start_line": 42,
      "end_line": 49,
      "content_hash": "e97d57abe4fc0993ba09982b348571e4e5725961",
      "content": "type DetectionState struct {\n\tLoopDetection      bool\n\tDriftDetection     bool\n\tEditResolution     bool\n\tContextCompression bool\n\tScriptGeneration   bool\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_Alert_50": {
      "name": "Alert",
      "type": "struct",
      "start_line": 50,
      "end_line": 58,
      "content_hash": "596c7192b7303a47b623e67f1d1bf40f10cba559",
      "content": "type Alert struct {\n\tType       string // \"loop\", \"drift\", \"resolution\"\n\tSeverity   string // \"warning\", \"error\", \"info\"\n\tMessage    string\n\tSuggestion string\n\tTimestamp  time.Time\n}\n\n// RenderAIOPSBlock renders the complete AIOPS status block.",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_RenderAIOPSBlock_59": {
      "name": "RenderAIOPSBlock",
      "type": "function",
      "start_line": 59,
      "end_line": 72,
      "content_hash": "0e82641b4a30231a9de75487fbc44a2c868dd521",
      "content": "func RenderAIOPSBlock(client aiops.Ops, opts RenderOptions) string {\n\tif client == nil || !client.Available() {\n\t\treturn renderDisconnectedState(opts)\n\t}\n\n\tstatus := getStatusFromClient(client)\n\n\tif opts.Compact {\n\t\treturn renderCompactStatus(status, opts)\n\t}\n\n\treturn renderFullStatus(status, opts)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_renderDisconnectedState_73": {
      "name": "renderDisconnectedState",
      "type": "function",
      "start_line": 73,
      "end_line": 90,
      "content_hash": "7cb4af6f0050035c35de2e0960340e61f1ace4be",
      "content": "func renderDisconnectedState(opts RenderOptions) string {\n\tt := styles.CurrentTheme()\n\tlines := []string{\n\t\tt.S().Base.Foreground(t.Border).Render(\"AIOPS\"),\n\t\t\"\",\n\t\tt.ItemOfflineIcon.String() + \" \" +\n\t\t\tt.S().Subtle.Render(\"Disconnected\"),\n\t\t\"\",\n\t\tt.S().Subtle.Render(\"Configure in settings\"),\n\t}\n\n\tcontent := lipgloss.JoinVertical(lipgloss.Left, lines...)\n\tif opts.MaxWidth > 0 {\n\t\treturn lipgloss.NewStyle().Width(opts.MaxWidth).Render(content)\n\t}\n\treturn content\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_renderFullStatus_91": {
      "name": "renderFullStatus",
      "type": "function",
      "start_line": 91,
      "end_line": 158,
      "content_hash": "77ced0f54d7f4278c684f12218124f883f5615ef",
      "content": "func renderFullStatus(status AIOPSStatus, opts RenderOptions) string {\n\tt := styles.CurrentTheme()\n\n\t// Header with model info\n\theader := fmt.Sprintf(\"%s %s \u2022 %s\",\n\t\tt.ItemOnlineIcon.String(),\n\t\tt.S().Base.Render(status.ModelInfo.Name),\n\t\tt.S().Subtle.Render(fmt.Sprintf(\"Latency: %v\", status.ModelInfo.Latency)))\n\n\t// Metrics section\n\tmetrics := []string{\n\t\tfmt.Sprintf(\"\u2022 Edit Resolutions: %d (%.0f%% avg)\",\n\t\t\tstatus.RecentMetrics.EditResolutions,\n\t\t\tstatus.RecentMetrics.AvgConfidence*100),\n\t\tfmt.Sprintf(\"\u2022 Loop Checks: %d (%s)\",\n\t\t\tstatus.RecentMetrics.LoopChecks,\n\t\t\tgetLoopStatusText(status.RecentMetrics.LoopChecks)),\n\t\tfmt.Sprintf(\"\u2022 Drift Score: %.1f (%s)\",\n\t\t\tstatus.RecentMetrics.DriftScore,\n\t\t\tgetDriftDescription(status.RecentMetrics.DriftScore)),\n\t}\n\n\t// Detection state\n\tdetectionStates := []string{\n\t\tgetDetectionIcon(status.DetectionState.LoopDetection) + \" Loop Detection: Active\",\n\t\tgetDetectionIcon(status.DetectionState.DriftDetection) + \" Drift Monitoring: Active\",\n\t\tgetDetectionIcon(status.DetectionState.EditResolution) + \" Edit Resolution: Ready\",\n\t}\n\n\tlines := []string{\n\t\tt.S().Base.Foreground(t.Border).Render(\"AIOPS\"),\n\t\t\"\",\n\t\theader,\n\t\t\"\",\n\t\tt.S().Subtle.Render(\"\u26a1 Recent Activity\"),\n\t}\n\n\tfor _, metric := range metrics {\n\t\tlines = append(lines, t.S().Subtle.Render(\"  \"+metric))\n\t}\n\n\tlines = append(lines, \"\", t.S().Subtle.Render(\"\ud83d\udcca Detection State\"))\n\tfor _, state := range detectionStates {\n\t\tlines = append(lines, t.S().Subtle.Render(\"  \"+state))\n\t}\n\n\t// Add alert if present\n\tif status.LastAlert != nil && time.Since(status.LastAlert.Timestamp) < 5*time.Minute {\n\t\talertColor := t.FgMuted\n\t\tif status.LastAlert.Severity == \"error\" {\n\t\t\talertColor = t.Error\n\t\t} else if status.LastAlert.Severity == \"warning\" {\n\t\t\talertColor = t.Yellow\n\t\t}\n\n\t\tlines = append(lines, \"\",\n\t\t\tt.S().Base.Foreground(alertColor).Render(\"\ud83d\udea8 Recent Alert\"))\n\t\tlines = append(lines,\n\t\t\tt.S().Subtle.Render(\"  \"+status.LastAlert.Type+\": \"+status.LastAlert.Message))\n\t}\n\n\tcontent := lipgloss.JoinVertical(lipgloss.Left, lines...)\n\tif opts.MaxWidth > 0 {\n\t\treturn lipgloss.NewStyle().Width(opts.MaxWidth).Render(content)\n\t}\n\treturn content\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_renderCompactStatus_159": {
      "name": "renderCompactStatus",
      "type": "function",
      "start_line": 159,
      "end_line": 181,
      "content_hash": "698fbef9479ee6024777b44683336831b360edc9",
      "content": "func renderCompactStatus(status AIOPSStatus, opts RenderOptions) string {\n\tt := styles.CurrentTheme()\n\n\tlines := []string{\n\t\tt.S().Base.Foreground(t.Border).Render(\"AIOPS\"),\n\t\tfmt.Sprintf(\"%s %s\",\n\t\t\tt.ItemOnlineIcon.String(),\n\t\t\tt.S().Base.Render(status.ModelInfo.Name)),\n\t\tfmt.Sprintf(\"%v \u2022 %.0f%%\",\n\t\t\tstatus.ModelInfo.Latency,\n\t\t\tstatus.RecentMetrics.AvgConfidence*100),\n\t\t\"\u2022 \" + getLoopStatusCompact(status.RecentMetrics.LoopChecks),\n\t\t\"\u2022 \" + fmt.Sprintf(\"%.1f drift\", status.RecentMetrics.DriftScore),\n\t}\n\n\tcontent := lipgloss.JoinVertical(lipgloss.Left, lines...)\n\tif opts.MaxWidth > 0 {\n\t\treturn lipgloss.NewStyle().Width(opts.MaxWidth).Render(content)\n\t}\n\treturn content\n}\n\n// RenderAIOPSList renders AIOPS in the same format as MCP list for compatibility",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_RenderAIOPSList_182": {
      "name": "RenderAIOPSList",
      "type": "function",
      "start_line": 182,
      "end_line": 272,
      "content_hash": "55c3507bc501141a7c149dbd18d7bc146c972d94",
      "content": "func RenderAIOPSList(client aiops.Ops, opts RenderOptions) []string {\n\tt := styles.CurrentTheme()\n\taiopsList := []string{}\n\n\tif opts.ShowSection {\n\t\tsectionName := opts.SectionName\n\t\tif sectionName == \"\" {\n\t\t\tsectionName = \"AIOPS\"\n\t\t}\n\t\tsection := t.S().Subtle.Render(sectionName)\n\t\taiopsList = append(aiopsList, section, \"\")\n\t}\n\n\tif client == nil || !client.Available() {\n\t\taiopsList = append(aiopsList,\n\t\t\tcore.Status(\n\t\t\t\tcore.StatusOpts{\n\t\t\t\t\tIcon:        t.ItemOfflineIcon.String(),\n\t\t\t\t\tTitle:       \"AIOPS Service\",\n\t\t\t\t\tDescription: t.S().Subtle.Render(\"disconnected\"),\n\t\t\t\t},\n\t\t\t\topts.MaxWidth,\n\t\t\t),\n\t\t)\n\t\treturn aiopsList\n\t}\n\n\t// Get AIOPS status\n\tstatus := getStatusFromClient(client)\n\n\t// Main service status\n\ticon := t.ItemOnlineIcon.String()\n\tdescription := \"\"\n\textraContent := []string{}\n\n\tif status.ModelInfo.Latency > 0 {\n\t\textraContent = append(extraContent, t.S().Subtle.Render(fmt.Sprintf(\"latency %v\", status.ModelInfo.Latency)))\n\t}\n\tif status.RecentMetrics.EditResolutions > 0 {\n\t\textraContent = append(extraContent, t.S().Subtle.Render(fmt.Sprintf(\"%d resolutions\", status.RecentMetrics.EditResolutions)))\n\t}\n\n\taiopsList = append(aiopsList,\n\t\tcore.Status(\n\t\t\tcore.StatusOpts{\n\t\t\t\tIcon:         icon,\n\t\t\t\tTitle:        status.ModelInfo.Name,\n\t\t\t\tDescription:  description,\n\t\t\t\tExtraContent: strings.Join(extraContent, \" \"),\n\t\t\t},\n\t\t\topts.MaxWidth,\n\t\t),\n\t)\n\n\t// Detection services as sub-items\n\tdetectionServices := []struct {\n\t\tname   string\n\t\tactive bool\n\t}{\n\t\t{\"Loop Detection\", status.DetectionState.LoopDetection},\n\t\t{\"Drift Detection\", status.DetectionState.DriftDetection},\n\t\t{\"Edit Resolution\", status.DetectionState.EditResolution},\n\t}\n\n\tfor _, service := range detectionServices {\n\t\tserviceIcon := t.ItemOfflineIcon.String()\n\t\tif service.active {\n\t\t\tserviceIcon = t.ItemOnlineIcon.String()\n\t\t}\n\n\t\taiopsList = append(aiopsList,\n\t\t\tcore.Status(\n\t\t\t\tcore.StatusOpts{\n\t\t\t\t\tIcon:  serviceIcon,\n\t\t\t\t\tTitle: \"  \" + service.name, // Indent for sub-item\n\t\t\t\t\tDescription: t.S().Subtle.Render(func() string {\n\t\t\t\t\t\tif service.active {\n\t\t\t\t\t\t\treturn \"active\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn \"inactive\"\n\t\t\t\t\t}()),\n\t\t\t\t},\n\t\t\t\topts.MaxWidth-2, // Account for indent\n\t\t\t),\n\t\t)\n\t}\n\n\treturn aiopsList\n}\n\n// Helper functions",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getStatusFromClient_273": {
      "name": "getStatusFromClient",
      "type": "function",
      "start_line": 273,
      "end_line": 296,
      "content_hash": "b86c794e287d540b45c1ab5485ee3627b3641d64",
      "content": "func getStatusFromClient(client aiops.Ops) AIOPSStatus {\n\tinfo := client.ModelInfo()\n\n\treturn AIOPSStatus{\n\t\tModelInfo: info,\n\t\tRecentMetrics: Metrics{\n\t\t\tEditResolutions: 0, // Get from agent tracking\n\t\t\tAvgConfidence:   0.85,\n\t\t\tLoopChecks:      2,\n\t\t\tDriftScore:      0.2,\n\t\t\tLastUpdate:      time.Now(),\n\t\t},\n\t\tDetectionState: DetectionState{\n\t\t\tLoopDetection:      true,\n\t\t\tDriftDetection:     true,\n\t\t\tEditResolution:     true,\n\t\t\tContextCompression: false,\n\t\t\tScriptGeneration:   false,\n\t\t},\n\t\tIsConnected: info.Available,\n\t\tUptime:      0, // Track when connected\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getDetectionIcon_297": {
      "name": "getDetectionIcon",
      "type": "function",
      "start_line": 297,
      "end_line": 304,
      "content_hash": "ba596ad6c8f7cf8cd2dd706fc5aa17b418258c8b",
      "content": "func getDetectionIcon(enabled bool) string {\n\tt := styles.CurrentTheme()\n\tif enabled {\n\t\treturn t.ItemOnlineIcon.String()\n\t}\n\treturn t.ItemOfflineIcon.String()\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getDriftDescription_305": {
      "name": "getDriftDescription",
      "type": "function",
      "start_line": 305,
      "end_line": 315,
      "content_hash": "d823c54476b4cc76c3ff73fdfac9c39941186731",
      "content": "func getDriftDescription(score float64) string {\n\tswitch {\n\tcase score < 0.3:\n\t\treturn \"on track\"\n\tcase score < 0.6:\n\t\treturn \"deviating\"\n\tdefault:\n\t\treturn \"off track\"\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getLoopStatusText_316": {
      "name": "getLoopStatusText",
      "type": "function",
      "start_line": 316,
      "end_line": 325,
      "content_hash": "f5991ec31cc500eee97cbf89e6b49acf1c73f2a6",
      "content": "func getLoopStatusText(checks int) string {\n\tif checks == 0 {\n\t\treturn \"no loops\"\n\t}\n\tif checks == 1 {\n\t\treturn \"1 check\"\n\t}\n\treturn fmt.Sprintf(\"%d checks\", checks)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getLoopStatusCompact_326": {
      "name": "getLoopStatusCompact",
      "type": "function",
      "start_line": 326,
      "end_line": 331,
      "content_hash": "56ba3c616db42634324b0413302deebe73efc232",
      "content": "func getLoopStatusCompact(checks int) string {\n\tif checks == 0 {\n\t\treturn \"no loops\"\n\t}\n\treturn fmt.Sprintf(\"%d loops checked\", checks)\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}