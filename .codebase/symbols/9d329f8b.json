{
  "file_path": "/work/.local/tools/modelscan/config/config.go",
  "file_hash": "4d84e5c6e92bf1b210367c9a87a009ee95ff9b49",
  "updated_at": "2025-12-26T17:34:20.346939",
  "symbols": {
    "struct_Config_12": {
      "name": "Config",
      "type": "struct",
      "start_line": 12,
      "end_line": 16,
      "content_hash": "36706f4d2fdf23eb5a5d19eb6604b62322639970",
      "content": "type Config struct {\n\tProviders map[string]ProviderConfig `json:\"providers\"`\n}\n\n// ProviderConfig holds provider-specific configuration",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_ProviderConfig_17": {
      "name": "ProviderConfig",
      "type": "struct",
      "start_line": 17,
      "end_line": 27,
      "content_hash": "b9179c4bfba655e62369bea3177f4b512a09ea37",
      "content": "type ProviderConfig struct {\n\tAPIKey      string `json:\"api_key\"`\n\tEndpoint    string `json:\"endpoint,omitempty\"`\n\tDescription string `json:\"description,omitempty\"`\n}\n\n// LoadConfig loads configuration from multiple sources in priority order:\n// 1. Environment variables\n// 2. ModelScan config file (~/.config/nexora/modelscan.config.json or local)\n// 3. NEXORA config from the project\n// 4. Agent environment variables",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_LoadConfig_28": {
      "name": "LoadConfig",
      "type": "function",
      "start_line": 28,
      "end_line": 64,
      "content_hash": "daeb76ea55079a32b7feeb4186ebdc21725ba5ff",
      "content": "func LoadConfig() (*Config, error) {\n\tconfig := &Config{\n\t\tProviders: make(map[string]ProviderConfig),\n\t}\n\n\t// First try to load from NEXORA config\n\tif err := loadFromNexoraConfig(config); err != nil {\n\t\t// It's okay if we can't find NEXORA config, continue with other sources\n\t}\n\n\t// Then load from Agent environment (has many more providers)\n\tif err := LoadFromAgentEnv(config); err != nil {\n\t\t// Continue even if agent env fails\n\t}\n\n\t// Extract additional providers\n\textractFromGamma(config)\n\textractFromManus(config)\n\textractFromLlamaIndex(config)\n\textractFromNanoGPT(config)\n\textractYouCom(config)\n\textractMinimax(config)\n\textractKimiForCoding(config)\n\textractFromVibe(config)\n\n\t// Then load from ModelScan config file\n\tif err := loadFromModelScanConfig(config); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to load ModelScan config: %w\", err)\n\t}\n\n\t// Finally override with environment variables\n\tloadFromEnvironment(config)\n\n\treturn config, nil\n}\n\n// loadFromNexoraConfig attempts to extract API keys from NEXORA's setup",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_loadFromNexoraConfig_65": {
      "name": "loadFromNexoraConfig",
      "type": "function",
      "start_line": 65,
      "end_line": 108,
      "content_hash": "70e320114eb10175cbde25763ac183336850acd1",
      "content": "func loadFromNexoraConfig(config *Config) error {\n\t// Try to get API key from environment (NEXORA's method)\n\tif mistralKey := os.Getenv(\"MISTRAL_API_KEY\"); mistralKey != \"\" {\n\t\tconfig.Providers[\"mistral\"] = ProviderConfig{\n\t\t\tAPIKey:      mistralKey,\n\t\t\tEndpoint:    \"https://api.mistral.ai/v1\",\n\t\t\tDescription: \"NEXORA Mistral API Key\",\n\t\t}\n\t}\n\n\t// Add other providers if available\n\tif openaiKey := os.Getenv(\"OPENAI_API_KEY\"); openaiKey != \"\" {\n\t\tconfig.Providers[\"openai\"] = ProviderConfig{\n\t\t\tAPIKey:      openaiKey,\n\t\t\tEndpoint:    \"https://api.openai.com/v1\",\n\t\t\tDescription: \"NEXORA OpenAI API Key\",\n\t\t}\n\t}\n\n\tif anthropicKey := os.Getenv(\"ANTHROPIC_API_KEY\"); anthropicKey != \"\" {\n\t\tconfig.Providers[\"anthropic\"] = ProviderConfig{\n\t\t\tAPIKey:      anthropicKey,\n\t\t\tEndpoint:    \"https://api.anthropic.com/v1\",\n\t\t\tDescription: \"NEXORA Anthropic API Key\",\n\t\t}\n\t}\n\n\t// Google/Gemini can use either env var\n\tgoogleKey := os.Getenv(\"GOOGLE_API_KEY\")\n\tif googleKey == \"\" {\n\t\tgoogleKey = os.Getenv(\"GEMINI_API_KEY\")\n\t}\n\tif googleKey != \"\" {\n\t\tconfig.Providers[\"google\"] = ProviderConfig{\n\t\t\tAPIKey:      googleKey,\n\t\t\tEndpoint:    \"https://generativelanguage.googleapis.com/v1\",\n\t\t\tDescription: \"NEXORA Google/Gemini API Key\",\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// loadFromModelScanConfig loads from local config file",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_loadFromModelScanConfig_109": {
      "name": "loadFromModelScanConfig",
      "type": "function",
      "start_line": 109,
      "end_line": 152,
      "content_hash": "29f0ce64c3ea86219cca69ab82db8839d99b224a",
      "content": "func loadFromModelScanConfig(config *Config) error {\n\t// Try multiple locations for the config file\n\tlocations := []string{\n\t\tfilepath.Join(os.Getenv(\"HOME\"), \".config\", \"nexora\", \"modelscan.config.json\"),\n\t\t\"modelscan.config.json\",\n\t\t\"./config/modelscan.config.json\",\n\t\t\".modelscan.config.json\",\n\t}\n\n\tvar configData []byte\n\tvar configPath string\n\tfor _, path := range locations {\n\t\tif data, err := os.ReadFile(path); err == nil {\n\t\t\tconfigData = data\n\t\t\tconfigPath = path\n\t\t\tbreak\n\t\t}\n\t}\n\n\tif configData != nil {\n\t\t// Parse existing config\n\t\tvar fileConfig Config\n\t\tif err := json.Unmarshal(configData, &fileConfig); err != nil {\n\t\t\treturn fmt.Errorf(\"failed to parse config file %s: %w\", configPath, err)\n\t\t}\n\n\t\t// Merge with existing config (NEXORA takes priority)\n\t\tfor provider, providerConfig := range fileConfig.Providers {\n\t\t\tif _, exists := config.Providers[provider]; !exists {\n\t\t\t\tconfig.Providers[provider] = providerConfig\n\t\t\t}\n\t\t}\n\t}\n\n\t// Save the merged config back to the preferred location\n\tpreferredPath := filepath.Join(os.Getenv(\"HOME\"), \".config\", \"nexora\", \"modelscan.config.json\")\n\tif err := saveConfig(config, preferredPath); err != nil {\n\t\treturn fmt.Errorf(\"failed to save config: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// loadFromEnvironment overrides config with environment variables",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_loadFromEnvironment_153": {
      "name": "loadFromEnvironment",
      "type": "function",
      "start_line": 153,
      "end_line": 177,
      "content_hash": "395d882c0b6ff80bee9f6242914b67e085115a13",
      "content": "func loadFromEnvironment(config *Config) {\n\t// Override with environment variables if set\n\tif apiKey := os.Getenv(\"MODELSCAN_MISTRAL_KEY\"); apiKey != \"\" {\n\t\tif config.Providers[\"mistral\"].Description == \"\" {\n\t\t\tcfg := config.Providers[\"mistral\"]\n\t\t\tcfg.Description = \"Environment override\"\n\t\t\tconfig.Providers[\"mistral\"] = cfg\n\t\t}\n\t\tcfg := config.Providers[\"mistral\"]\n\t\tcfg.APIKey = apiKey\n\t\tconfig.Providers[\"mistral\"] = cfg\n\t}\n\tif apiKey := os.Getenv(\"MODELSCAN_OPENAI_KEY\"); apiKey != \"\" {\n\t\tproviderConfig := ProviderConfig{Description: \"Environment override\"}\n\t\tproviderConfig.APIKey = apiKey\n\t\tconfig.Providers[\"openai\"] = providerConfig\n\t}\n\tif apiKey := os.Getenv(\"MODELSCAN_ANTHROPIC_KEY\"); apiKey != \"\" {\n\t\tproviderConfig := ProviderConfig{Description: \"Environment override\"}\n\t\tproviderConfig.APIKey = apiKey\n\t\tconfig.Providers[\"anthropic\"] = providerConfig\n\t}\n}\n\n// saveConfig saves configuration to the specified path",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_saveConfig_178": {
      "name": "saveConfig",
      "type": "function",
      "start_line": 178,
      "end_line": 219,
      "content_hash": "b072b34eb18ef9c951fc203593bb7a14a456dbae",
      "content": "func saveConfig(config *Config, path string) error {\n\t// Ensure directory exists\n\tif err := os.MkdirAll(filepath.Dir(path), 0o755); err != nil {\n\t\treturn err\n\t}\n\n\t// Create a copy without secret keys for saving\n\tsafeConfig := &Config{\n\t\tProviders: make(map[string]ProviderConfig),\n\t}\n\n\tfor provider, cfg := range config.Providers {\n\t\t// Only save if we have an API key\n\t\tif cfg.APIKey != \"\" {\n\t\t\t// Save API key in a way that can be restored\n\t\t\tif strings.HasPrefix(cfg.APIKey, \"$\") {\n\t\t\t\t// Already an environment reference\n\t\t\t\tsafeConfig.Providers[provider] = ProviderConfig{\n\t\t\t\t\tEndpoint:    cfg.Endpoint,\n\t\t\t\t\tDescription: cfg.Description,\n\t\t\t\t\tAPIKey:      cfg.APIKey,\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Save as empty, user can set manually if needed\n\t\t\t\tsafeConfig.Providers[provider] = ProviderConfig{\n\t\t\t\t\tEndpoint:    cfg.Endpoint,\n\t\t\t\t\tDescription: cfg.Description,\n\t\t\t\t\tAPIKey:      \"\",\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdata, err := json.MarshalIndent(safeConfig, \"\", \"  \")\n\tif err != nil {\n\t\treturn err\n\t}\n\n\treturn os.WriteFile(path, data, 0o600)\n}\n\n// GetAPIKey returns the API key for a provider",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetAPIKey_220": {
      "name": "GetAPIKey",
      "type": "method",
      "start_line": 220,
      "end_line": 233,
      "content_hash": "adbd57735c92e5838a6c294bd32f3d482e9953f4",
      "content": "func (c *Config) GetAPIKey(provider string) (string, error) {\n\tconfig, exists := c.Providers[provider]\n\tif !exists {\n\t\treturn \"\", fmt.Errorf(\"no configuration found for provider: %s\", provider)\n\t}\n\n\tif config.APIKey == \"\" {\n\t\treturn \"\", fmt.Errorf(\"no API key configured for provider: %s\", provider)\n\t}\n\n\treturn config.APIKey, nil\n}\n\n// HasProvider checks if a provider is configured",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_HasProvider_234": {
      "name": "HasProvider",
      "type": "method",
      "start_line": 234,
      "end_line": 239,
      "content_hash": "8230bc7fc330dee57981563b70f357506e1d83c1",
      "content": "func (c *Config) HasProvider(provider string) bool {\n\t_, exists := c.Providers[provider]\n\treturn exists && c.Providers[provider].APIKey != \"\"\n}\n\n// ListProviders returns a list of configured providers",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ListProviders_240": {
      "name": "ListProviders",
      "type": "method",
      "start_line": 240,
      "end_line": 248,
      "content_hash": "1b675d121fef62c4512a008d07c5f35afb7a7b6a",
      "content": "func (c *Config) ListProviders() []string {\n\tvar providers []string\n\tfor provider, config := range c.Providers {\n\t\tif config.APIKey != \"\" {\n\t\t\tproviders = append(providers, provider)\n\t\t}\n\t}\n\treturn providers\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}