{
  "file_path": "/work/external-deps/claude-mem/scripts/smart-install.js",
  "file_hash": "40eb421574883e71cfcfa958d537149202f9e30e",
  "updated_at": "2025-12-26T17:34:20.924274",
  "symbols": {
    "function_getBunPath_29": {
      "name": "getBunPath",
      "type": "function",
      "start_line": 29,
      "end_line": 44,
      "content_hash": "89fa3195dab72406a5294d0c808340ff6320a342",
      "content": "function getBunPath() {\n  // Try PATH first\n  try {\n    const result = spawnSync('bun', ['--version'], {\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'pipe'],\n      shell: IS_WINDOWS\n    });\n    if (result.status === 0) return 'bun';\n  } catch {\n    // Not in PATH\n  }\n\n  // Check common installation paths\n  return BUN_COMMON_PATHS.find(existsSync) || null;\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_isBunInstalled_49": {
      "name": "isBunInstalled",
      "type": "function",
      "start_line": 49,
      "end_line": 51,
      "content_hash": "1169cee1b6cd54abfd3a265b72ad990dbba83a49",
      "content": "function isBunInstalled() {\n  return getBunPath() !== null;\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getBunVersion_56": {
      "name": "getBunVersion",
      "type": "function",
      "start_line": 56,
      "end_line": 70,
      "content_hash": "3f0d22c38d58c85924fecf1f75311809976d4e2f",
      "content": "function getBunVersion() {\n  const bunPath = getBunPath();\n  if (!bunPath) return null;\n\n  try {\n    const result = spawnSync(bunPath, ['--version'], {\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'pipe'],\n      shell: IS_WINDOWS\n    });\n    return result.status === 0 ? result.stdout.trim() : null;\n  } catch {\n    return null;\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getUvPath_75": {
      "name": "getUvPath",
      "type": "function",
      "start_line": 75,
      "end_line": 90,
      "content_hash": "dbff2bf4fbe6641655537c2ebc67ec4019818993",
      "content": "function getUvPath() {\n  // Try PATH first\n  try {\n    const result = spawnSync('uv', ['--version'], {\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'pipe'],\n      shell: IS_WINDOWS\n    });\n    if (result.status === 0) return 'uv';\n  } catch {\n    // Not in PATH\n  }\n\n  // Check common installation paths\n  return UV_COMMON_PATHS.find(existsSync) || null;\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_isUvInstalled_95": {
      "name": "isUvInstalled",
      "type": "function",
      "start_line": 95,
      "end_line": 97,
      "content_hash": "467aec40f5ed8ec133340d22aaa74bb84ac177f3",
      "content": "function isUvInstalled() {\n  return getUvPath() !== null;\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_getUvVersion_102": {
      "name": "getUvVersion",
      "type": "function",
      "start_line": 102,
      "end_line": 116,
      "content_hash": "b622155e6be98ed9ec525c67101ec4ad67b194f8",
      "content": "function getUvVersion() {\n  const uvPath = getUvPath();\n  if (!uvPath) return null;\n\n  try {\n    const result = spawnSync(uvPath, ['--version'], {\n      encoding: 'utf-8',\n      stdio: ['pipe', 'pipe', 'pipe'],\n      shell: IS_WINDOWS\n    });\n    return result.status === 0 ? result.stdout.trim() : null;\n  } catch {\n    return null;\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_installBun_121": {
      "name": "installBun",
      "type": "function",
      "start_line": 121,
      "end_line": 161,
      "content_hash": "a7cc47a57671d473eccae6e4dfbc881c0eff1a48",
      "content": "function installBun() {\n  console.error('\ud83d\udd27 Bun not found. Installing Bun runtime...');\n\n  try {\n    if (IS_WINDOWS) {\n      console.error('   Installing via PowerShell...');\n      execSync('powershell -c \"irm bun.sh/install.ps1 | iex\"', {\n        stdio: 'inherit',\n        shell: true\n      });\n    } else {\n      console.error('   Installing via curl...');\n      execSync('curl -fsSL https://bun.sh/install | bash', {\n        stdio: 'inherit',\n        shell: true\n      });\n    }\n\n    if (!isBunInstalled()) {\n      throw new Error(\n        'Bun installation completed but binary not found. ' +\n        'Please restart your terminal and try again.'\n      );\n    }\n\n    const version = getBunVersion();\n    console.error(`\u2705 Bun ${version} installed successfully`);\n  } catch (error) {\n    console.error('\u274c Failed to install Bun');\n    console.error('   Please install manually:');\n    if (IS_WINDOWS) {\n      console.error('   - winget install Oven-sh.Bun');\n      console.error('   - Or: powershell -c \"irm bun.sh/install.ps1 | iex\"');\n    } else {\n      console.error('   - curl -fsSL https://bun.sh/install | bash');\n      console.error('   - Or: brew install oven-sh/bun/bun');\n    }\n    console.error('   Then restart your terminal and try again.');\n    throw error;\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_installUv_166": {
      "name": "installUv",
      "type": "function",
      "start_line": 166,
      "end_line": 206,
      "content_hash": "df1f5cddd78fa32f524035398b2ac9275644e34c",
      "content": "function installUv() {\n  console.error('\ud83d\udc0d Installing uv for Python/Chroma support...');\n\n  try {\n    if (IS_WINDOWS) {\n      console.error('   Installing via PowerShell...');\n      execSync('powershell -ExecutionPolicy ByPass -c \"irm https://astral.sh/uv/install.ps1 | iex\"', {\n        stdio: 'inherit',\n        shell: true\n      });\n    } else {\n      console.error('   Installing via curl...');\n      execSync('curl -LsSf https://astral.sh/uv/install.sh | sh', {\n        stdio: 'inherit',\n        shell: true\n      });\n    }\n\n    if (!isUvInstalled()) {\n      throw new Error(\n        'uv installation completed but binary not found. ' +\n        'Please restart your terminal and try again.'\n      );\n    }\n\n    const version = getUvVersion();\n    console.error(`\u2705 uv ${version} installed successfully`);\n  } catch (error) {\n    console.error('\u274c Failed to install uv');\n    console.error('   Please install manually:');\n    if (IS_WINDOWS) {\n      console.error('   - winget install astral-sh.uv');\n      console.error('   - Or: powershell -c \"irm https://astral.sh/uv/install.ps1 | iex\"');\n    } else {\n      console.error('   - curl -LsSf https://astral.sh/uv/install.sh | sh');\n      console.error('   - Or: brew install uv (macOS)');\n    }\n    console.error('   Then restart your terminal and try again.');\n    throw error;\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_needsInstall_211": {
      "name": "needsInstall",
      "type": "function",
      "start_line": 211,
      "end_line": 220,
      "content_hash": "a7718dec7ef7ff877df9e78d54bbff3ed8113748",
      "content": "function needsInstall() {\n  if (!existsSync(join(ROOT, 'node_modules'))) return true;\n  try {\n    const pkg = JSON.parse(readFileSync(join(ROOT, 'package.json'), 'utf-8'));\n    const marker = JSON.parse(readFileSync(MARKER, 'utf-8'));\n    return pkg.version !== marker.version || getBunVersion() !== marker.bun;\n  } catch {\n    return true;\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_installDeps_225": {
      "name": "installDeps",
      "type": "function",
      "start_line": 225,
      "end_line": 246,
      "content_hash": "f313e0a28afac03293312ac1083dc2074a8773e4",
      "content": "function installDeps() {\n  const bunPath = getBunPath();\n  if (!bunPath) {\n    throw new Error('Bun executable not found');\n  }\n\n  console.error('\ud83d\udce6 Installing dependencies with Bun...');\n\n  // Quote path for Windows paths with spaces\n  const bunCmd = IS_WINDOWS && bunPath.includes(' ') ? `\"${bunPath}\"` : bunPath;\n\n  execSync(`${bunCmd} install`, { cwd: ROOT, stdio: 'inherit', shell: IS_WINDOWS });\n\n  // Write version marker\n  const pkg = JSON.parse(readFileSync(join(ROOT, 'package.json'), 'utf-8'));\n  writeFileSync(MARKER, JSON.stringify({\n    version: pkg.version,\n    bun: getBunVersion(),\n    uv: getUvVersion(),\n    installedAt: new Date().toISOString()\n  }));\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}