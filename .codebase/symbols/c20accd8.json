{
  "file_path": "/work/internal/config/providers/zai_test.go",
  "file_hash": "b2c15752779e5033d89defb67309dbd8f8298f02",
  "updated_at": "2025-12-26T17:34:21.186889",
  "symbols": {
    "function_TestZAIProvider_11": {
      "name": "TestZAIProvider",
      "type": "function",
      "start_line": 11,
      "end_line": 87,
      "content_hash": "078b198c95329525e057f454a59b8e99197a36ba",
      "content": "func TestZAIProvider(t *testing.T) {\n\tt.Run(\"creates provider with correct basic info\", func(t *testing.T) {\n\t\tprovider := ZAIProvider([]catwalk.Provider{})\n\n\t\trequire.NotNil(t, provider)\n\t\tassert.Equal(t, \"zai\", string(provider.ID))\n\t\tassert.Equal(t, \"Z.AI\", provider.Name)\n\t\tassert.Equal(t, \"openai-compat\", string(provider.Type))\n\t\tassert.Equal(t, \"$ZAI_API_KEY\", provider.APIKey)\n\t\tassert.Equal(t, \"https://api.z.ai/api/paas/v4\", provider.APIEndpoint)\n\t})\n\n\tt.Run(\"creates provider with GLM models\", func(t *testing.T) {\n\t\tprovider := ZAIProvider([]catwalk.Provider{})\n\n\t\trequire.NotNil(t, provider)\n\t\trequire.Len(t, provider.Models, 7)\n\t\tassert.Equal(t, \"glm-4.6\", provider.DefaultLargeModelID)\n\t\tassert.Equal(t, \"glm-4.5-air\", provider.DefaultSmallModelID)\n\t})\n\n\tt.Run(\"does not create if already exists\", func(t *testing.T) {\n\t\texistingProvider := catwalk.Provider{ID: \"zai\"}\n\t\tprovider := ZAIProvider([]catwalk.Provider{existingProvider})\n\n\t\tassert.Equal(t, \"\", string(provider.ID))\n\t})\n\n\tt.Run(\"has glm-4.6 flagship model\", func(t *testing.T) {\n\t\tprovider := ZAIProvider([]catwalk.Provider{})\n\n\t\tvar glm46Model *catwalk.Model\n\t\tfor i := range provider.Models {\n\t\t\tif provider.Models[i].ID == \"glm-4.6\" {\n\t\t\t\tglm46Model = &provider.Models[i]\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\trequire.NotNil(t, glm46Model)\n\t\tassert.Equal(t, \"GLM-4.6\", glm46Model.Name)\n\t\tassert.Equal(t, 0.6, glm46Model.CostPer1MIn)\n\t\tassert.Equal(t, 2.2, glm46Model.CostPer1MOut)\n\t\tassert.Equal(t, int64(200000), glm46Model.ContextWindow)\n\t})\n\n\tt.Run(\"has free flash models\", func(t *testing.T) {\n\t\tprovider := ZAIProvider([]catwalk.Provider{})\n\n\t\tvar flashModel *catwalk.Model\n\t\tfor i := range provider.Models {\n\t\t\tif provider.Models[i].ID == \"glm-4.5-flash\" {\n\t\t\t\tflashModel = &provider.Models[i]\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\trequire.NotNil(t, flashModel)\n\t\tassert.Equal(t, 0.0, flashModel.CostPer1MIn)\n\t\tassert.Equal(t, 0.0, flashModel.CostPer1MOut)\n\t})\n\n\tt.Run(\"has vision models\", func(t *testing.T) {\n\t\tprovider := ZAIProvider([]catwalk.Provider{})\n\n\t\tvar visionModel *catwalk.Model\n\t\tfor i := range provider.Models {\n\t\t\tif provider.Models[i].ID == \"glm-4.6v\" {\n\t\t\t\tvisionModel = &provider.Models[i]\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\trequire.NotNil(t, visionModel)\n\t\tassert.True(t, visionModel.SupportsImages)\n\t})\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}