{
  "file_path": "/work/internal/agent/agents/agent_executor.go",
  "file_hash": "e225983c20366e9a818c606d8733cd5cc99c2329",
  "updated_at": "2025-12-26T17:34:22.170241",
  "symbols": {
    "struct_AgentExecutor_13": {
      "name": "AgentExecutor",
      "type": "struct",
      "start_line": 13,
      "end_line": 17,
      "content_hash": "d075b1b68e608d8cfd29bd698d1a62049e6d7a63",
      "content": "type AgentExecutor struct {\n\tregistry *AgentRegistry\n}\n\n// NewAgentExecutor creates a new agent executor",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_NewAgentExecutor_18": {
      "name": "NewAgentExecutor",
      "type": "function",
      "start_line": 18,
      "end_line": 24,
      "content_hash": "139537aadb4096b43aeb68f36d51bd8977f8490a",
      "content": "func NewAgentExecutor(registry *AgentRegistry) *AgentExecutor {\n\treturn &AgentExecutor{\n\t\tregistry: registry,\n\t}\n}\n\n// ExecuteForInput finds and returns the best agent for given input",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ExecuteForInput_25": {
      "name": "ExecuteForInput",
      "type": "method",
      "start_line": 25,
      "end_line": 42,
      "content_hash": "41269a56e22d0adff4611f14646e8975fe91ef84",
      "content": "func (e *AgentExecutor) ExecuteForInput(ctx context.Context, input string, tools []string) (*AgentConfig, string, error) {\n\t// Find matching agent\n\tagent := e.registry.MatchAgent(input)\n\tif agent == nil {\n\t\treturn nil, \"\", fmt.Errorf(\"no agent found for input: %s\", input)\n\t}\n\n\t// Validate agent has access to requested tools\n\tif err := e.validateToolAccess(agent, tools); err != nil {\n\t\treturn nil, \"\", fmt.Errorf(\"tool access validation failed: %w\", err)\n\t}\n\n\t// Return agent with formatted prompt\n\tprompt := e.formatAgentPrompt(agent, input)\n\treturn agent, prompt, nil\n}\n\n// ExecuteAgent executes a specific agent",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ExecuteAgent_43": {
      "name": "ExecuteAgent",
      "type": "method",
      "start_line": 43,
      "end_line": 54,
      "content_hash": "ad3341043646772dfe18c0e0a57a06863a190913",
      "content": "func (e *AgentExecutor) ExecuteAgent(ctx context.Context, agent *AgentConfig, input string, tools []string) (*AgentConfig, string, error) {\n\t// Validate agent has access to requested tools\n\tif err := e.validateToolAccess(agent, tools); err != nil {\n\t\treturn nil, \"\", fmt.Errorf(\"tool access validation failed: %w\", err)\n\t}\n\n\t// Create prompt with agent's system prompt\n\tprompt := e.formatAgentPrompt(agent, input)\n\treturn agent, prompt, nil\n}\n\n// formatAgentPrompt creates the full prompt for an agent",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_formatAgentPrompt_55": {
      "name": "formatAgentPrompt",
      "type": "method",
      "start_line": 55,
      "end_line": 59,
      "content_hash": "8b8d0c606c34d3dbde4bb47bd205cb494abf365c",
      "content": "func (e *AgentExecutor) formatAgentPrompt(agent *AgentConfig, input string) string {\n\treturn fmt.Sprintf(\"%s\\n\\nUser: %s\", agent.SystemPrompt, input)\n}\n\n// validateToolAccess checks if agent is allowed to use requested tools",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_validateToolAccess_60": {
      "name": "validateToolAccess",
      "type": "method",
      "start_line": 60,
      "end_line": 76,
      "content_hash": "7300a958c691a99d0949690566232a87a9a4db17",
      "content": "func (e *AgentExecutor) validateToolAccess(agent *AgentConfig, requestedTools []string) error {\n\t// If agent has no tool restrictions, allow all\n\tif len(agent.Tools) == 0 {\n\t\treturn nil\n\t}\n\n\t// Check each requested tool is in agent's allowed list\n\tfor _, tool := range requestedTools {\n\t\tif !slices.Contains(agent.Tools, tool) {\n\t\t\treturn fmt.Errorf(\"agent '%s' not allowed to use tool '%s'\", agent.Name, tool)\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// colorResponse applies visual styling to agent responses",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_colorResponse_77": {
      "name": "colorResponse",
      "type": "method",
      "start_line": 77,
      "end_line": 101,
      "content_hash": "7e5f05cf61941ddcdbb5cf70bc1ce656f956596f",
      "content": "func (e *AgentExecutor) colorResponse(response string, color string) string {\n\tstyle := lipgloss.NewStyle()\n\n\tswitch color {\n\tcase \"green\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"10\"))\n\tcase \"blue\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"12\"))\n\tcase \"red\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"9\"))\n\tcase \"yellow\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"11\"))\n\tcase \"cyan\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"14\"))\n\tcase \"magenta\":\n\t\tstyle = style.Foreground(lipgloss.Color(\"13\"))\n\tdefault:\n\t\t// No coloring for unknown colors\n\t\treturn response\n\t}\n\n\treturn style.Render(response)\n}\n\n// GetAgent returns an agent by name",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetAgent_102": {
      "name": "GetAgent",
      "type": "method",
      "start_line": 102,
      "end_line": 106,
      "content_hash": "734bab46be42069c7eca19c64f29342a0a9a2dcb",
      "content": "func (e *AgentExecutor) GetAgent(name string) (*AgentConfig, bool) {\n\treturn e.registry.GetAgent(name)\n}\n\n// ListAgents returns all available agent names",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ListAgents_107": {
      "name": "ListAgents",
      "type": "method",
      "start_line": 107,
      "end_line": 111,
      "content_hash": "452a64fd72bb10c8b5b1e7997ce06b0e15e25f86",
      "content": "func (e *AgentExecutor) ListAgents() []string {\n\treturn e.registry.ListAgents()\n}\n\n// CreateAgent creates a new agent from the given configuration",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CreateAgent_112": {
      "name": "CreateAgent",
      "type": "method",
      "start_line": 112,
      "end_line": 123,
      "content_hash": "ccbd708eedaf50ad4d8fd169656b18954e47c5ea",
      "content": "func (e *AgentExecutor) CreateAgent(config *AgentConfig) error {\n\t// Validate the agent configuration\n\tif err := ValidateAgent(config); err != nil {\n\t\treturn fmt.Errorf(\"invalid agent configuration: %w\", err)\n\t}\n\n\t// Add to registry\n\te.registry.agents[config.Name] = config\n\treturn nil\n}\n\n// RemoveAgent removes an agent from the registry",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_RemoveAgent_124": {
      "name": "RemoveAgent",
      "type": "method",
      "start_line": 124,
      "end_line": 133,
      "content_hash": "c9f8e8410562024bd66fce7406f4f82bbbfff607",
      "content": "func (e *AgentExecutor) RemoveAgent(name string) error {\n\tif _, exists := e.registry.GetAgent(name); !exists {\n\t\treturn fmt.Errorf(\"agent '%s' not found\", name)\n\t}\n\n\tdelete(e.registry.agents, name)\n\treturn nil\n}\n\n// ExplainTriggering explains why an agent was selected",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ExplainTriggering_134": {
      "name": "ExplainTriggering",
      "type": "method",
      "start_line": 134,
      "end_line": 154,
      "content_hash": "e35afad17fc58879a7c6e183cfe2800f6fda3743",
      "content": "func (e *AgentExecutor) ExplainTriggering(input string) string {\n\tagent := e.registry.MatchAgent(input)\n\tif agent == nil {\n\t\treturn \"No agent matched\"\n\t}\n\n\tinput = strings.ToLower(input)\n\tmatchedTriggers := make([]string, 0)\n\n\tfor _, trigger := range agent.Triggers {\n\t\tif strings.Contains(input, strings.ToLower(trigger)) {\n\t\t\tmatchedTriggers = append(matchedTriggers, trigger)\n\t\t}\n\t}\n\n\tif len(matchedTriggers) == 0 {\n\t\treturn fmt.Sprintf(\"Agent '%s' selected but no clear triggers matched\", agent.Name)\n\t}\n\n\treturn fmt.Sprintf(\"Agent '%s' selected due to triggers: %s\", agent.Name, strings.Join(matchedTriggers, \", \"))\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}