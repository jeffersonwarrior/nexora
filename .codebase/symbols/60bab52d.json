{
  "file_path": "/work/internal/indexer/p5_test.go",
  "file_hash": "5604b86a43108f9c16a2d8777f9082df2140a411",
  "updated_at": "2025-12-26T17:34:21.595357",
  "symbols": {
    "function_TestP5Interfaces_11": {
      "name": "TestP5Interfaces",
      "type": "function",
      "start_line": 11,
      "end_line": 84,
      "content_hash": "6855632bd650aed826387ae93c47095d040f30ab",
      "content": "func TestP5Interfaces(t *testing.T) {\n\tctx := context.Background()\n\n\tt.Run(\"Dependency Injection\", func(t *testing.T) {\n\t\t// Create a complete indexer system with DI\n\t\tconfig := DefaultIndexerSystemConfig()\n\t\tbuilder, err := CreateIndexerSystem(config)\n\t\tif err != nil {\n\t\t\tt.Fatalf(\"Failed to create indexer system: %v\", err)\n\t\t}\n\n\t\t// Test built info\n\t\tinfo := builder.GetBuildInfo()\n\t\tif !info.IsBuilt {\n\t\t\tt.Error(\"System should be built\")\n\t\t}\n\t\tif info.ServiceCount == 0 {\n\t\t\tt.Error(\"Should have built services\")\n\t\t}\n\t})\n\n\tt.Run(\"Event System\", func(t *testing.T) {\n\t\t// Test event bus\n\t\tbus := NewEventBus(ctx)\n\n\t\t// Test logging handler\n\t\tloggingHandler := NewLoggingHandler()\n\t\tbus.RegisterHandler([]EventType{EventAdded, EventRemoved}, loggingHandler)\n\n\t\t// Test event\n\t\tevent := NewFileChangeEvent(\"/test/file.go\", EventAdded)\n\t\terr := bus.PublishEvent(event)\n\t\tif err != nil {\n\t\t\tt.Fatalf(\"Failed to publish event: %v\", err)\n\t\t}\n\n\t\t// Test stats\n\t\tstats := bus.GetStats()\n\t\tif stats.TotalHandlers == 0 {\n\t\t\tt.Error(\"Should have registered handlers\")\n\t\t}\n\t})\n\n\tt.Run(\"File Type Helpers\", func(t *testing.T) {\n\t\tif !IsGoFile(\"test.go\") {\n\t\t\tt.Error(\"test.go should be identified as Go file\")\n\t\t}\n\t\tif IsGoFile(\"test.txt\") {\n\t\t\tt.Error(\"test.txt should not be identified as Go file\")\n\t\t}\n\t\tif !IsTestFile(\"example_test.go\") {\n\t\t\tt.Error(\"example_test.go should be identified as test file\")\n\t\t}\n\t})\n\n\tt.Run(\"Factory Pattern\", func(t *testing.T) {\n\t\tcontainer := NewDIContainer()\n\n\t\t// Test indexer factory\n\t\tindexerFactory := NewIndexerServiceFactory(SymbolStoreConfig{\n\t\t\tDatabasePath: \":memory:\",\n\t\t})\n\n\t\t_, err := indexerFactory.Create(ctx, container)\n\t\tif err != nil {\n\t\t\tt.Fatalf(\"Failed to create indexer: %v\", err)\n\t\t}\n\n\t\t// Verify service exists\n\t\tif !container.Has(\"indexer\") {\n\t\t\tt.Error(\"Indexer service should be registered\")\n\t\t}\n\t})\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}