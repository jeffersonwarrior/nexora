{
  "file_path": "/work/external-deps/helix-db/helix-db/src/helix_engine/tests/traversal_tests/update_tests.rs",
  "file_hash": "2fbc0552f8263ca102f66ae9dba937fbb6ead109",
  "updated_at": "2025-12-26T17:34:22.024620",
  "symbols": {
    "function_setup_test_db_23": {
      "name": "setup_test_db",
      "type": "function",
      "start_line": 23,
      "end_line": 35,
      "content_hash": "08bb0f06064d2277b5cf43aecf3c82469d11003e",
      "content": "fn setup_test_db() -> (TempDir, Arc<HelixGraphStorage>) {\n    let temp_dir = TempDir::new().unwrap();\n    let db_path = temp_dir.path().to_str().unwrap();\n    let storage = HelixGraphStorage::new(\n        db_path,\n        crate::helix_engine::traversal_core::config::Config::default(),\n        Default::default(),\n    )\n    .unwrap();\n    (temp_dir, Arc::new(storage))\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_update_node_36": {
      "name": "test_update_node",
      "type": "function",
      "start_line": 36,
      "end_line": 79,
      "content_hash": "dc84fa585207db62cc07d012623b302db6eda334",
      "content": "fn test_update_node() {\n    let (_temp_dir, storage) = setup_test_db();\n    let arena = Bump::new();\n    let mut txn = storage.graph_env.write_txn().unwrap();\n\n    let node = G::new_mut(&storage, &arena, &mut txn)\n        .add_n(\"person\", props_option(&arena, props!(\"name\" => \"test\")), None)\n        .collect_to_obj().unwrap();\n    G::new_mut(&storage, &arena, &mut txn)\n        .add_n(\"person\", props_option(&arena, props!(\"name\" => \"test2\")), None)\n        .collect_to_obj().unwrap();\n    txn.commit().unwrap();\n\n    let arena_read = Bump::new();\n    let txn = storage.graph_env.read_txn().unwrap();\n    let traversal = G::new(&storage, &txn, &arena_read)\n        .n_from_id(&node.id())\n        .collect::<Result<Vec<_>,_>>().unwrap();\n    drop(txn);\n\n    let arena = Bump::new();\n    let mut txn = storage.graph_env.write_txn().unwrap();\n    G::new_mut_from_iter(&storage, &mut txn, traversal.into_iter(), &arena)\n        .update(&[(\"name\", Value::from(\"john\"))])\n        .collect::<Result<Vec<_>,_>>().unwrap();\n    txn.commit().unwrap();\n\n    let arena = Bump::new();\n    let txn = storage.graph_env.read_txn().unwrap();\n    let updated = G::new(&storage, &txn, &arena)\n        .n_from_id(&node.id())\n        .collect::<Result<Vec<_>,_>>().unwrap();\n    assert_eq!(updated.len(), 1);\n\n    match &updated[0] {\n        TraversalValue::Node(node) => {\n            match node.properties.as_ref().unwrap().get(\"name\").unwrap() {\n                Value::String(name) => assert_eq!(name, \"john\"),\n                other => panic!(\"unexpected value {other:?}\"),\n            }\n        }\n        other => panic!(\"unexpected traversal value: {other:?}\"),\n    }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}