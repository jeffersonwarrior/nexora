{
  "file_path": "/work/internal/version/version_test.go",
  "file_hash": "d58b4d338fb1fe84187405ca21a08a2656306f8b",
  "updated_at": "2025-12-26T17:34:20.889943",
  "symbols": {
    "function_TestVersion_9": {
      "name": "TestVersion",
      "type": "function",
      "start_line": 9,
      "end_line": 22,
      "content_hash": "1a67fa7bde45ff884ec540345e23a2b45d64749a",
      "content": "func TestVersion(t *testing.T) {\n\t// Test that the version is set\n\tif Version == \"\" {\n\t\tt.Error(\"Version should not be empty\")\n\t}\n\n\t// Test version format (should be semver-like or \"(devel)\")\n\tif !strings.HasPrefix(Version, \"v\") && !strings.HasPrefix(Version, \"0.\") && Version != \"(devel)\" {\n\t\tt.Logf(\"Version format: %q\", Version)\n\t}\n\n\tt.Logf(\"Current version: %s\", Version)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionInit_23": {
      "name": "TestVersionInit",
      "type": "function",
      "start_line": 23,
      "end_line": 45,
      "content_hash": "e9425162530336757edf95fdd37cf37846debb08",
      "content": "func TestVersionInit(t *testing.T) {\n\t// This test verifies that the init() function runs without panicking\n\t// and that the version is accessible\n\n\t// The init function should have already run before this test\n\tif Version == \"\" {\n\t\tt.Error(\"Version should be initialized by init()\")\n\t}\n\n\t// Check that we can read build info (may not be available in all build modes)\n\tinfo, ok := debug.ReadBuildInfo()\n\tif ok {\n\t\tt.Logf(\"Build info available: %v\", info.Main.Version)\n\n\t\t// Verify main module\n\t\tif info.Main.Path != \"\" {\n\t\t\tt.Logf(\"Main module path: %s\", info.Main.Path)\n\t\t}\n\t} else {\n\t\tt.Log(\"Build info not available (normal for some build modes)\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionStability_46": {
      "name": "TestVersionStability",
      "type": "function",
      "start_line": 46,
      "end_line": 59,
      "content_hash": "e70f7da83aae71014105116150f3cb741accebf6",
      "content": "func TestVersionStability(t *testing.T) {\n\t// Version should remain constant during runtime\n\toriginalVersion := Version\n\n\t// Call some operations\n\tinfo, _ := debug.ReadBuildInfo()\n\t_ = info\n\n\t// Verify version hasn't changed\n\tif Version != originalVersion {\n\t\tt.Errorf(\"Version changed during test: was %q, now %q\", originalVersion, Version)\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionExpectedValues_60": {
      "name": "TestVersionExpectedValues",
      "type": "function",
      "start_line": 60,
      "end_line": 104,
      "content_hash": "c844c4c93e64ca31b3a6d208b752baa5afe1a565",
      "content": "func TestVersionExpectedValues(t *testing.T) {\n\ttests := []struct {\n\t\tname  string\n\t\tcheck func() bool\n\t\tdesc  string\n\t}{\n\t\t{\n\t\t\tname: \"not empty\",\n\t\t\tcheck: func() bool {\n\t\t\t\treturn Version != \"\"\n\t\t\t},\n\t\t\tdesc: \"Version should not be empty\",\n\t\t},\n\t\t{\n\t\t\tname: \"reasonable length\",\n\t\t\tcheck: func() bool {\n\t\t\t\treturn len(Version) > 0 && len(Version) < 100\n\t\t\t},\n\t\t\tdesc: \"Version should have reasonable length\",\n\t\t},\n\t\t{\n\t\t\tname: \"valid version format\",\n\t\t\tcheck: func() bool {\n\t\t\t\t// Should be either:\n\t\t\t\t// - Starts with \"v\" (like v1.2.3)\n\t\t\t\t// - Starts with digit (like 0.28.5)\n\t\t\t\t// - Is \"(devel)\"\n\t\t\t\treturn strings.HasPrefix(Version, \"v\") ||\n\t\t\t\t\tstrings.HasPrefix(Version, \"0.\") ||\n\t\t\t\t\tstrings.HasPrefix(Version, \"1.\") ||\n\t\t\t\t\tVersion == \"(devel)\"\n\t\t\t},\n\t\t\tdesc: \"Version should follow expected format\",\n\t\t},\n\t}\n\n\tfor _, tt := range tests {\n\t\tt.Run(tt.name, func(t *testing.T) {\n\t\t\tif !tt.check() {\n\t\t\t\tt.Errorf(\"%s: got %q\", tt.desc, Version)\n\t\t\t}\n\t\t})\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionAgainstBuildInfo_105": {
      "name": "TestVersionAgainstBuildInfo",
      "type": "function",
      "start_line": 105,
      "end_line": 127,
      "content_hash": "9ff543ff44bdee9a576a888c8259f51aafe05d55",
      "content": "func TestVersionAgainstBuildInfo(t *testing.T) {\n\tinfo, ok := debug.ReadBuildInfo()\n\tif !ok {\n\t\tt.Skip(\"Build info not available\")\n\t}\n\n\tmainVersion := info.Main.Version\n\tt.Logf(\"BuildInfo version: %q, Package version: %q\", mainVersion, Version)\n\n\t// If we have a non-devel build, check the logic\n\tif mainVersion != \"(devel)\" && mainVersion != \"\" {\n\t\t// The init function should have potentially updated Version\n\t\t// based on the build info\n\n\t\t// If mainVersion starts with \"v0.28\" and Version is \"0.28.5\",\n\t\t// that means the version wasn't overridden (expected behavior)\n\t\tif strings.HasPrefix(mainVersion, \"v0.28\") && Version == \"0.28.5\" {\n\t\t\tt.Log(\"Version correctly kept as 0.28.5 for v0.28.x build\")\n\t\t}\n\t}\n}\n\n// TestVersionPackageConstants ensures the constants are properly defined",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionPackageConstants_128": {
      "name": "TestVersionPackageConstants",
      "type": "function",
      "start_line": 128,
      "end_line": 139,
      "content_hash": "ea3b483e66e1c6bba66db3a3679f08900a0ed077",
      "content": "func TestVersionPackageConstants(t *testing.T) {\n\t// This would fail at compile time if Version wasn't declared,\n\t// but we can still verify it's accessible\n\t_ = Version\n\n\t// Verify we can compare and use it\n\tif Version == Version {\n\t\tt.Log(\"Version variable is accessible and comparable\")\n\t}\n}\n\n// TestVersionInitLogic simulates different build scenarios",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestVersionInitLogic_140": {
      "name": "TestVersionInitLogic",
      "type": "function",
      "start_line": 140,
      "end_line": 170,
      "content_hash": "d3dfbc7c537721b0e2e19f72a4cf231276f8bb1d",
      "content": "func TestVersionInitLogic(t *testing.T) {\n\t// We can't actually re-run init(), but we can verify the current state\n\t// makes sense given the init() logic\n\n\tinfo, ok := debug.ReadBuildInfo()\n\tif !ok {\n\t\tt.Skip(\"Build info not available, can't test init logic\")\n\t}\n\n\tmainVersion := info.Main.Version\n\n\tt.Run(\"devel version handling\", func(t *testing.T) {\n\t\tif mainVersion == \"(devel)\" {\n\t\t\t// Init should have kept the default or ldflags version\n\t\t\tif Version == \"\" {\n\t\t\t\tt.Error(\"Version should not be empty even in devel mode\")\n\t\t\t}\n\t\t\tt.Logf(\"Devel mode: Version = %q\", Version)\n\t\t}\n\t})\n\n\tt.Run(\"tagged version handling\", func(t *testing.T) {\n\t\tif mainVersion != \"\" && mainVersion != \"(devel)\" {\n\t\t\t// Init may have updated Version based on mainVersion\n\t\t\t// This depends on the specific conditions in init()\n\t\t\tt.Logf(\"Tagged version: mainVersion=%q, Version=%q\", mainVersion, Version)\n\t\t}\n\t})\n}\n\n// BenchmarkVersionAccess tests the performance of accessing the version",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_BenchmarkVersionAccess_171": {
      "name": "BenchmarkVersionAccess",
      "type": "function",
      "start_line": 171,
      "end_line": 180,
      "content_hash": "3e8c601718d3cd759d90ef085e9756682ac62962",
      "content": "func BenchmarkVersionAccess(b *testing.B) {\n\tvar v string\n\tb.ResetTimer()\n\tfor i := 0; i < b.N; i++ {\n\t\tv = Version\n\t}\n\t_ = v\n}\n\n// BenchmarkReadBuildInfo tests the performance of reading build info",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_BenchmarkReadBuildInfo_181": {
      "name": "BenchmarkReadBuildInfo",
      "type": "function",
      "start_line": 181,
      "end_line": 186,
      "content_hash": "d31d1161c08706401ba7b192de91f5ae6bf306da",
      "content": "func BenchmarkReadBuildInfo(b *testing.B) {\n\tb.ResetTimer()\n\tfor i := 0; i < b.N; i++ {\n\t\tdebug.ReadBuildInfo()\n\t}\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}