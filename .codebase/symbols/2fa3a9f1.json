{
  "file_path": "/work/external-deps/Context-Engine/.github/workflows/publish-cli.yml",
  "file_hash": "e00f7f671abe19da2369c528c7dd7080bf691475",
  "updated_at": "2025-12-26T17:34:20.723678",
  "symbols": {
    "key_name_1": {
      "name": "name",
      "type": "key",
      "start_line": 1,
      "end_line": 1,
      "content_hash": "c69915f63d4675812e8f2f5997598901c1c6754d",
      "content": "name: Publish ctxce CLI to npm",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on_3": {
      "name": "on",
      "type": "key",
      "start_line": 3,
      "end_line": 9,
      "content_hash": "988b34ce15a8035b7734bd1785b8ad36a2cf5fd0",
      "content": "on:\n  workflow_dispatch:\n  push:\n    branches:\n      - test\n    paths:\n      - \"ctx-mcp-bridge/package.json\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.workflow_dispatch_4": {
      "name": "on.workflow_dispatch",
      "type": "key",
      "start_line": 4,
      "end_line": 4,
      "content_hash": "9d55e62244dd2e683f9f9153af7efd66d4894293",
      "content": "  workflow_dispatch:",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.push_5": {
      "name": "on.push",
      "type": "key",
      "start_line": 5,
      "end_line": 9,
      "content_hash": "ebf4b06a7d96e943bf14a07009ed7deedbe6ae60",
      "content": "  push:\n    branches:\n      - test\n    paths:\n      - \"ctx-mcp-bridge/package.json\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.push.branches_6": {
      "name": "on.push.branches",
      "type": "key",
      "start_line": 6,
      "end_line": 7,
      "content_hash": "6a840bcb8aa9885eba71750d85c6f98276628537",
      "content": "    branches:\n      - test",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_on.push.paths_8": {
      "name": "on.push.paths",
      "type": "key",
      "start_line": 8,
      "end_line": 9,
      "content_hash": "4c0d8621ea2120b2a1e49462d6be5623c57dfd1e",
      "content": "    paths:\n      - \"ctx-mcp-bridge/package.json\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs_11": {
      "name": "jobs",
      "type": "key",
      "start_line": 11,
      "end_line": 67,
      "content_hash": "63a6e5171d6c0b0c04b88e0252d81d28950f984e",
      "content": "jobs:\n  publish:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      id-token: write\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Use Node.js 20\n        uses: actions/setup-node@v4\n        with:\n          node-version: \"20\"\n          registry-url: \"https://registry.npmjs.org\"\n\n      - name: Check bridge version change\n        id: version_check\n        shell: bash\n        run: |\n          set -euo pipefail\n\n          PKG_PATH=\"ctx-mcp-bridge/package.json\"\n          CURRENT_VERSION=\"$(node -p \"require('./' + process.env.PKG_PATH).version\")\"\n\n          PREVIOUS_VERSION=\"\"\n          if git cat-file -e \"${{ github.event.before }}:${PKG_PATH}\" 2>/dev/null; then\n            PREVIOUS_VERSION=\"$(git show \"${{ github.event.before }}:${PKG_PATH}\" | node -e 'let d=\"\";process.stdin.on(\"data\",c=>d+=c);process.stdin.on(\"end\",()=>{try{console.log(JSON.parse(d).version||\"\")}catch(e){console.log(\"\")}})')\"\n          fi\n\n          ALREADY_PUBLISHED=false\n          if npm view \"@context-engine-bridge/context-engine-mcp-bridge@${CURRENT_VERSION}\" version >/dev/null 2>&1; then\n            ALREADY_PUBLISHED=true\n          fi\n\n          echo \"current_version=${CURRENT_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"previous_version=${PREVIOUS_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"already_published=${ALREADY_PUBLISHED}\" >> \"$GITHUB_OUTPUT\"\n\n          if [[ -n \"$CURRENT_VERSION\" && \"$CURRENT_VERSION\" != \"$PREVIOUS_VERSION\" ]]; then\n            echo \"changed=true\" >> \"$GITHUB_OUTPUT\"\n          else\n            echo \"changed=false\" >> \"$GITHUB_OUTPUT\"\n          fi\n        env:\n          PKG_PATH: \"ctx-mcp-bridge/package.json\"\n\n      - name: Install dependencies\n        working-directory: ctx-mcp-bridge\n        run: npm install\n\n      - name: Publish to npm\n        if: steps.version_check.outputs.changed == 'true' && steps.version_check.outputs.already_published != 'true'\n        working-directory: ctx-mcp-bridge\n        run: npm publish --access public --provenance\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish_12": {
      "name": "jobs.publish",
      "type": "key",
      "start_line": 12,
      "end_line": 67,
      "content_hash": "58efd3a8c6bc73103a43e984139782c23500aa0f",
      "content": "  publish:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      id-token: write\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Use Node.js 20\n        uses: actions/setup-node@v4\n        with:\n          node-version: \"20\"\n          registry-url: \"https://registry.npmjs.org\"\n\n      - name: Check bridge version change\n        id: version_check\n        shell: bash\n        run: |\n          set -euo pipefail\n\n          PKG_PATH=\"ctx-mcp-bridge/package.json\"\n          CURRENT_VERSION=\"$(node -p \"require('./' + process.env.PKG_PATH).version\")\"\n\n          PREVIOUS_VERSION=\"\"\n          if git cat-file -e \"${{ github.event.before }}:${PKG_PATH}\" 2>/dev/null; then\n            PREVIOUS_VERSION=\"$(git show \"${{ github.event.before }}:${PKG_PATH}\" | node -e 'let d=\"\";process.stdin.on(\"data\",c=>d+=c);process.stdin.on(\"end\",()=>{try{console.log(JSON.parse(d).version||\"\")}catch(e){console.log(\"\")}})')\"\n          fi\n\n          ALREADY_PUBLISHED=false\n          if npm view \"@context-engine-bridge/context-engine-mcp-bridge@${CURRENT_VERSION}\" version >/dev/null 2>&1; then\n            ALREADY_PUBLISHED=true\n          fi\n\n          echo \"current_version=${CURRENT_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"previous_version=${PREVIOUS_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"already_published=${ALREADY_PUBLISHED}\" >> \"$GITHUB_OUTPUT\"\n\n          if [[ -n \"$CURRENT_VERSION\" && \"$CURRENT_VERSION\" != \"$PREVIOUS_VERSION\" ]]; then\n            echo \"changed=true\" >> \"$GITHUB_OUTPUT\"\n          else\n            echo \"changed=false\" >> \"$GITHUB_OUTPUT\"\n          fi\n        env:\n          PKG_PATH: \"ctx-mcp-bridge/package.json\"\n\n      - name: Install dependencies\n        working-directory: ctx-mcp-bridge\n        run: npm install\n\n      - name: Publish to npm\n        if: steps.version_check.outputs.changed == 'true' && steps.version_check.outputs.already_published != 'true'\n        working-directory: ctx-mcp-bridge\n        run: npm publish --access public --provenance\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.runs-on_13": {
      "name": "jobs.publish.runs-on",
      "type": "key",
      "start_line": 13,
      "end_line": 13,
      "content_hash": "af41e65e8de6d5fac9a3ffe97c9153f19e320298",
      "content": "    runs-on: ubuntu-latest",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.permissions_14": {
      "name": "jobs.publish.permissions",
      "type": "key",
      "start_line": 14,
      "end_line": 16,
      "content_hash": "52859640ab3712480fc543723cc8c774f5e1dc61",
      "content": "    permissions:\n      contents: read\n      id-token: write",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.permissions.contents_15": {
      "name": "jobs.publish.permissions.contents",
      "type": "key",
      "start_line": 15,
      "end_line": 15,
      "content_hash": "f2046ba96290365428b2ab8dfef59603a0705386",
      "content": "      contents: read",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.permissions.id-token_16": {
      "name": "jobs.publish.permissions.id-token",
      "type": "key",
      "start_line": 16,
      "end_line": 16,
      "content_hash": "34bcde03bbb67945e9dcb517271df8b04e9cb71d",
      "content": "      id-token: write",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps_17": {
      "name": "jobs.publish.steps",
      "type": "key",
      "start_line": 17,
      "end_line": 67,
      "content_hash": "1f37b6feb42d460468d6e77e0e6912d38ef4de7e",
      "content": "    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Use Node.js 20\n        uses: actions/setup-node@v4\n        with:\n          node-version: \"20\"\n          registry-url: \"https://registry.npmjs.org\"\n\n      - name: Check bridge version change\n        id: version_check\n        shell: bash\n        run: |\n          set -euo pipefail\n\n          PKG_PATH=\"ctx-mcp-bridge/package.json\"\n          CURRENT_VERSION=\"$(node -p \"require('./' + process.env.PKG_PATH).version\")\"\n\n          PREVIOUS_VERSION=\"\"\n          if git cat-file -e \"${{ github.event.before }}:${PKG_PATH}\" 2>/dev/null; then\n            PREVIOUS_VERSION=\"$(git show \"${{ github.event.before }}:${PKG_PATH}\" | node -e 'let d=\"\";process.stdin.on(\"data\",c=>d+=c);process.stdin.on(\"end\",()=>{try{console.log(JSON.parse(d).version||\"\")}catch(e){console.log(\"\")}})')\"\n          fi\n\n          ALREADY_PUBLISHED=false\n          if npm view \"@context-engine-bridge/context-engine-mcp-bridge@${CURRENT_VERSION}\" version >/dev/null 2>&1; then\n            ALREADY_PUBLISHED=true\n          fi\n\n          echo \"current_version=${CURRENT_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"previous_version=${PREVIOUS_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"already_published=${ALREADY_PUBLISHED}\" >> \"$GITHUB_OUTPUT\"\n\n          if [[ -n \"$CURRENT_VERSION\" && \"$CURRENT_VERSION\" != \"$PREVIOUS_VERSION\" ]]; then\n            echo \"changed=true\" >> \"$GITHUB_OUTPUT\"\n          else\n            echo \"changed=false\" >> \"$GITHUB_OUTPUT\"\n          fi\n        env:\n          PKG_PATH: \"ctx-mcp-bridge/package.json\"\n\n      - name: Install dependencies\n        working-directory: ctx-mcp-bridge\n        run: npm install\n\n      - name: Publish to npm\n        if: steps.version_check.outputs.changed == 'true' && steps.version_check.outputs.already_published != 'true'\n        working-directory: ctx-mcp-bridge\n        run: npm publish --access public --provenance\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.uses_18": {
      "name": "jobs.publish.steps.uses",
      "type": "key",
      "start_line": 18,
      "end_line": 18,
      "content_hash": "94d776ea972ae48be1086fe6571c992a21d00df4",
      "content": "      - uses: actions/checkout@v4",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.with_19": {
      "name": "jobs.publish.steps.with",
      "type": "key",
      "start_line": 19,
      "end_line": 20,
      "content_hash": "38910da64e7409895b0e8a55e07cd91314738251",
      "content": "        with:\n          fetch-depth: 0",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.with.fetch-depth_20": {
      "name": "jobs.publish.steps.with.fetch-depth",
      "type": "key",
      "start_line": 20,
      "end_line": 20,
      "content_hash": "687e678a957c0b91b601014b0e772738670300ff",
      "content": "          fetch-depth: 0",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.name_22": {
      "name": "jobs.publish.steps.name",
      "type": "key",
      "start_line": 22,
      "end_line": 22,
      "content_hash": "c527663fc3cd05082f8b9f35cf4dd9677f5a0739",
      "content": "      - name: Use Node.js 20",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.uses_23": {
      "name": "jobs.publish.steps.uses",
      "type": "key",
      "start_line": 23,
      "end_line": 23,
      "content_hash": "41d462b6f163386b74268ce4f3e5695fc56e3806",
      "content": "        uses: actions/setup-node@v4",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.with_24": {
      "name": "jobs.publish.steps.with",
      "type": "key",
      "start_line": 24,
      "end_line": 26,
      "content_hash": "1f56938d6554a7e53070e4ffcfd5b98bcf15d6dc",
      "content": "        with:\n          node-version: \"20\"\n          registry-url: \"https://registry.npmjs.org\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.with.node-version_25": {
      "name": "jobs.publish.steps.with.node-version",
      "type": "key",
      "start_line": 25,
      "end_line": 25,
      "content_hash": "e32fd4eae64b2e413f551e1e79506c5e95197e02",
      "content": "          node-version: \"20\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.with.registry-url_26": {
      "name": "jobs.publish.steps.with.registry-url",
      "type": "key",
      "start_line": 26,
      "end_line": 26,
      "content_hash": "a598865c6943d1a31501014ac752c29a0c77031a",
      "content": "          registry-url: \"https://registry.npmjs.org\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.name_28": {
      "name": "jobs.publish.steps.name",
      "type": "key",
      "start_line": 28,
      "end_line": 28,
      "content_hash": "07fcc3c19eab923ba92ac9877937df5db6842953",
      "content": "      - name: Check bridge version change",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.id_29": {
      "name": "jobs.publish.steps.id",
      "type": "key",
      "start_line": 29,
      "end_line": 29,
      "content_hash": "963975f06da3ac358a546620ebb9d675ecbb70f1",
      "content": "        id: version_check",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.shell_30": {
      "name": "jobs.publish.steps.shell",
      "type": "key",
      "start_line": 30,
      "end_line": 30,
      "content_hash": "070f3c79ffb5e86b2dba7ae8c3a975b5526378b8",
      "content": "        shell: bash",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.run_31": {
      "name": "jobs.publish.steps.run",
      "type": "key",
      "start_line": 31,
      "end_line": 55,
      "content_hash": "ffa67a313ef2a6c9a85de875f23a01e35d1e11d0",
      "content": "        run: |\n          set -euo pipefail\n\n          PKG_PATH=\"ctx-mcp-bridge/package.json\"\n          CURRENT_VERSION=\"$(node -p \"require('./' + process.env.PKG_PATH).version\")\"\n\n          PREVIOUS_VERSION=\"\"\n          if git cat-file -e \"${{ github.event.before }}:${PKG_PATH}\" 2>/dev/null; then\n            PREVIOUS_VERSION=\"$(git show \"${{ github.event.before }}:${PKG_PATH}\" | node -e 'let d=\"\";process.stdin.on(\"data\",c=>d+=c);process.stdin.on(\"end\",()=>{try{console.log(JSON.parse(d).version||\"\")}catch(e){console.log(\"\")}})')\"\n          fi\n\n          ALREADY_PUBLISHED=false\n          if npm view \"@context-engine-bridge/context-engine-mcp-bridge@${CURRENT_VERSION}\" version >/dev/null 2>&1; then\n            ALREADY_PUBLISHED=true\n          fi\n\n          echo \"current_version=${CURRENT_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"previous_version=${PREVIOUS_VERSION}\" >> \"$GITHUB_OUTPUT\"\n          echo \"already_published=${ALREADY_PUBLISHED}\" >> \"$GITHUB_OUTPUT\"\n\n          if [[ -n \"$CURRENT_VERSION\" && \"$CURRENT_VERSION\" != \"$PREVIOUS_VERSION\" ]]; then\n            echo \"changed=true\" >> \"$GITHUB_OUTPUT\"\n          else\n            echo \"changed=false\" >> \"$GITHUB_OUTPUT\"\n          fi",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.env_56": {
      "name": "jobs.publish.steps.env",
      "type": "key",
      "start_line": 56,
      "end_line": 57,
      "content_hash": "0861122a7ba308e42f3eb2f0a4ad981dd23a90ea",
      "content": "        env:\n          PKG_PATH: \"ctx-mcp-bridge/package.json\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.env.PKG_PATH_57": {
      "name": "jobs.publish.steps.env.PKG_PATH",
      "type": "key",
      "start_line": 57,
      "end_line": 57,
      "content_hash": "747010dc50530472c92e0144996c77ed81379d82",
      "content": "          PKG_PATH: \"ctx-mcp-bridge/package.json\"",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.name_59": {
      "name": "jobs.publish.steps.name",
      "type": "key",
      "start_line": 59,
      "end_line": 59,
      "content_hash": "f4676278e24ca1ac974f42460e40443b7fcf2454",
      "content": "      - name: Install dependencies",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.working-directory_60": {
      "name": "jobs.publish.steps.working-directory",
      "type": "key",
      "start_line": 60,
      "end_line": 60,
      "content_hash": "782720c5d2ce1c27188a63bc04925613b64bc54d",
      "content": "        working-directory: ctx-mcp-bridge",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.run_61": {
      "name": "jobs.publish.steps.run",
      "type": "key",
      "start_line": 61,
      "end_line": 61,
      "content_hash": "51eec145b7a62fcf665245b53217fa2091719a24",
      "content": "        run: npm install",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.name_63": {
      "name": "jobs.publish.steps.name",
      "type": "key",
      "start_line": 63,
      "end_line": 63,
      "content_hash": "335d3a3a5d1057e9efdd56b95ac0bbf7ee97708a",
      "content": "      - name: Publish to npm",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.if_64": {
      "name": "jobs.publish.steps.if",
      "type": "key",
      "start_line": 64,
      "end_line": 64,
      "content_hash": "239913b74774300512dcba55b775ddc25ad1423b",
      "content": "        if: steps.version_check.outputs.changed == 'true' && steps.version_check.outputs.already_published != 'true'",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.working-directory_65": {
      "name": "jobs.publish.steps.working-directory",
      "type": "key",
      "start_line": 65,
      "end_line": 65,
      "content_hash": "782720c5d2ce1c27188a63bc04925613b64bc54d",
      "content": "        working-directory: ctx-mcp-bridge",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "key_jobs.publish.steps.run_66": {
      "name": "jobs.publish.steps.run",
      "type": "key",
      "start_line": 66,
      "end_line": 66,
      "content_hash": "f06da9bd3feba431a579852c25ff722c8b4e8dce",
      "content": "        run: npm publish --access public --provenance",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}