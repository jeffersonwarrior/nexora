{
  "file_path": "/work/internal/agent/tools/search_indexed.go",
  "file_hash": "cb7f72c549bb67cb3b09ad031ced9850e6743ba2",
  "updated_at": "2025-12-26T17:34:23.443780",
  "symbols": {
    "struct_SearchIndexedParams_12": {
      "name": "SearchIndexedParams",
      "type": "struct",
      "start_line": 12,
      "end_line": 21,
      "content_hash": "9cf68f29e41f81398d7e0e80540e802ffe3a5edf",
      "content": "type SearchIndexedParams struct {\n\tQuery       string   `json:\"query\" description:\"Search query or question about the codebase\"`\n\tType        string   `json:\"type,omitempty\" description:\"Search type: all (default), semantic, text, or graph\"`\n\tLimit       int      `json:\"limit,omitempty\" description:\"Maximum number of results to return (default: 20)\"`\n\tContext     string   `json:\"context,omitempty\" description:\"Filter by package, file, or type context\"`\n\tSymbolTypes []string `json:\"symbol_types,omitempty\" description:\"Filter by symbol types: func, struct, interface, var, const\"`\n\tIncludeDocs bool     `json:\"include_docs,omitempty\" description:\"Include documentation in search results\"`\n}\n\n// NewSearchIndexedTool creates a new search indexed tool",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_NewSearchIndexedTool_22": {
      "name": "NewSearchIndexedTool",
      "type": "function",
      "start_line": 22,
      "end_line": 71,
      "content_hash": "9c2d95dbfa638331c463461dc6a09f8df6b52a6f",
      "content": "func NewSearchIndexedTool(queryEngine *indexer.QueryEngine) fantasy.AgentTool {\n\treturn fantasy.NewAgentTool(\n\t\t\"search_indexed\",\n\t\t\"Search code using AI-accelerated indexing with semantic, text, and graph search capabilities\",\n\t\tfunc(ctx context.Context, params SearchIndexedParams, call fantasy.ToolCall) (fantasy.ToolResponse, error) {\n\t\t\tif queryEngine == nil {\n\t\t\t\treturn fantasy.NewTextErrorResponse(\"search indexed tool is not available - indexer not initialized\"), nil\n\t\t\t}\n\n\t\t\tif params.Query == \"\" {\n\t\t\t\treturn fantasy.NewTextErrorResponse(\"query parameter is required\"), nil\n\t\t\t}\n\n\t\t\t// Set defaults\n\t\t\tif params.Type == \"\" {\n\t\t\t\tparams.Type = \"all\"\n\t\t\t}\n\t\t\tif params.Limit == 0 {\n\t\t\t\tparams.Limit = 20\n\t\t\t}\n\n\t\t\t// Convert to indexer QueryRequest\n\t\t\tqueryType, err := parseQueryType(params.Type)\n\t\t\tif err != nil {\n\t\t\t\treturn fantasy.NewTextErrorResponse(fmt.Sprintf(\"Error: %v\", err)), nil\n\t\t\t}\n\n\t\t\treq := &indexer.QueryRequest{\n\t\t\t\tQuery:       params.Query,\n\t\t\t\tType:        queryType,\n\t\t\t\tLimit:       params.Limit,\n\t\t\t\tContext:     params.Context,\n\t\t\t\tSymbolTypes: params.SymbolTypes,\n\t\t\t\tIncludeDocs: params.IncludeDocs,\n\t\t\t}\n\n\t\t\t// Execute search\n\t\t\tresult, err := queryEngine.Search(ctx, req)\n\t\t\tif err != nil {\n\t\t\t\treturn fantasy.NewTextErrorResponse(fmt.Sprintf(\"Search failed: %v\", err)), nil\n\t\t\t}\n\n\t\t\t// Format results\n\t\t\toutput := formatResults(result, params)\n\t\t\treturn fantasy.NewTextResponse(output), nil\n\t\t},\n\t)\n}\n\n// parseQueryType converts string query type to indexer.QueryType",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_parseQueryType_72": {
      "name": "parseQueryType",
      "type": "function",
      "start_line": 72,
      "end_line": 87,
      "content_hash": "1589cc1e8d08b21dc7077afe2913cfeeea4965d3",
      "content": "func parseQueryType(typeStr string) (indexer.QueryType, error) {\n\tswitch strings.ToLower(typeStr) {\n\tcase \"all\":\n\t\treturn indexer.QueryTypeAll, nil\n\tcase \"semantic\":\n\t\treturn indexer.QueryTypeSemantic, nil\n\tcase \"text\":\n\t\treturn indexer.QueryTypeText, nil\n\tcase \"graph\":\n\t\treturn indexer.QueryTypeGraph, nil\n\tdefault:\n\t\treturn indexer.QueryTypeAll, fmt.Errorf(\"unknown query type: %s\", typeStr)\n\t}\n}\n\n// formatResults formats search results for display",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_formatResults_88": {
      "name": "formatResults",
      "type": "function",
      "start_line": 88,
      "end_line": 141,
      "content_hash": "9fdac3ce75499f1ad64f0e36de6786f3ce6e194a",
      "content": "func formatResults(result *indexer.SearchResult, params SearchIndexedParams) string {\n\tvar output strings.Builder\n\n\t// Header\n\toutput.WriteString(fmt.Sprintf(\"\ud83d\udd0d Search Results for: %s\\n\", result.Query))\n\toutput.WriteString(fmt.Sprintf(\"\ud83d\udcca Type: %v | Total: %d results | Duration: %s\\n\\n\",\n\t\tresult.Type, result.Total, result.Duration))\n\n\tif len(result.Results) == 0 {\n\t\toutput.WriteString(\"No results found.\\n\")\n\t\treturn output.String()\n\t}\n\n\t// Results\n\tfor i, res := range result.Results {\n\t\toutput.WriteString(fmt.Sprintf(\"%d. **%s** `%s`\\n\", i+1, res.Symbol.Name, res.Symbol.Type))\n\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udccd Location: %s\\n\", res.Location))\n\t\toutput.WriteString(fmt.Sprintf(\"   \ud83c\udfaf Score: %.3f (%s)\\n\", res.Score, res.MatchType))\n\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udca1 Reason: %s\\n\", res.Reason))\n\n\t\t// Package context\n\t\tif res.Symbol.Package != \"\" {\n\t\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udce6 Package: %s\\n\", res.Symbol.Package))\n\t\t}\n\n\t\t// Documentation (if available and not too long)\n\t\tif res.Symbol.Doc != \"\" && len(res.Symbol.Doc) < 200 {\n\t\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udcd6 Documentation: %s\\n\", res.Symbol.Doc))\n\t\t}\n\n\t\t// Signature (if available and not too long)\n\t\tif res.Symbol.Signature != \"\" && len(res.Symbol.Signature) < 200 {\n\t\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udd0d Signature: %s\\n\", res.Symbol.Signature))\n\t\t} else if res.Symbol.Signature != \"\" {\n\t\t\t// truncated signature for very long ones\n\t\t\ttruncated := res.Symbol.Signature\n\t\t\tif len(truncated) > 200 {\n\t\t\t\ttruncated = truncated[:197] + \"...\"\n\t\t\t}\n\t\t\toutput.WriteString(fmt.Sprintf(\"   \ud83d\udd0d Signature: %s\\n\", truncated))\n\t\t}\n\n\t\toutput.WriteString(\"\\n\")\n\t}\n\n\t// Footer with tips\n\toutput.WriteString(\"\ud83d\udca1 **Tips:**\\n\")\n\toutput.WriteString(\"   \u2022 Use semantic search for finding code by intent\\n\")\n\toutput.WriteString(\"   \u2022 Use text search for exact name or pattern matching\\n\")\n\toutput.WriteString(\"   \u2022 Use graph search for finding related or dependent code\\n\")\n\toutput.WriteString(\"   \u2022 Filter results with `type:`, `context:`, or `symbol_types:` parameters\\n\")\n\n\treturn output.String()\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}