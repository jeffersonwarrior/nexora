{
  "file_path": "/work/internal/task/agent_tool.go",
  "file_hash": "b4005dd1fdbcfb441f4eefa2b5cf5dcb1679bd57",
  "updated_at": "2025-12-26T17:34:19.959957",
  "symbols": {
    "struct_TaskTool_12": {
      "name": "TaskTool",
      "type": "struct",
      "start_line": 12,
      "end_line": 17,
      "content_hash": "ade46c8c77232abba07d0e5bd5d6b1fe3f22f632",
      "content": "type TaskTool struct {\n\ttaskService Service\n\tsessionID   string\n}\n\n// NewTaskTool creates a task management tool for agent use",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_NewTaskTool_18": {
      "name": "NewTaskTool",
      "type": "function",
      "start_line": 18,
      "end_line": 25,
      "content_hash": "4868ac6b75f0e94d0e004d81fe7b67d9ae66c654",
      "content": "func NewTaskTool(taskService Service, sessionID string) *TaskTool {\n\treturn &TaskTool{\n\t\ttaskService: taskService,\n\t\tsessionID:   sessionID,\n\t}\n}\n\n// AgentTaskInput represents input for task operations",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_AgentTaskInput_26": {
      "name": "AgentTaskInput",
      "type": "struct",
      "start_line": 26,
      "end_line": 34,
      "content_hash": "981c6a1ad3dbd571467e143603149d0d02d6988c",
      "content": "type AgentTaskInput struct {\n\tTaskID      string   `json:\"task_id,omitempty\"`\n\tTitle       string   `json:\"title,omitempty\"`\n\tDescription string   `json:\"description,omitempty\"`\n\tMilestones  []string `json:\"milestones,omitempty\"`\n\tMessage     string   `json:\"message,omitempty\"`\n}\n\n// AgentTaskOutput represents output from task operations",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_AgentTaskOutput_35": {
      "name": "AgentTaskOutput",
      "type": "struct",
      "start_line": 35,
      "end_line": 43,
      "content_hash": "f783c84007111b9c191450b1da849d3370286a88",
      "content": "type AgentTaskOutput struct {\n\tSuccess    bool        `json:\"success\"`\n\tMessage    string      `json:\"message\"`\n\tTaskStatus TaskSummary `json:\"task_status,omitempty\"`\n\tDriftAlert bool        `json:\"drift_alert,omitempty\"`\n\tDriftMsg   string      `json:\"drift_message,omitempty\"`\n}\n\n// StartTask begins a new focused task",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_StartTask_44": {
      "name": "StartTask",
      "type": "method",
      "start_line": 44,
      "end_line": 60,
      "content_hash": "c5854558193523a03ec88307872241f4dbdbe25c",
      "content": "func (tt *TaskTool) StartTask(ctx context.Context, input AgentTaskInput) (*AgentTaskOutput, error) {\n\tif input.Title == \"\" {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess: false,\n\t\t\tMessage: \"Task title is required\",\n\t\t}, nil\n\t}\n\n\ttask := tt.taskService.CreateTask(ctx, tt.sessionID, input.Title, input.Description, fmt.Sprintf(\"Focus: %s\", input.Description), input.Milestones)\n\n\treturn &AgentTaskOutput{\n\t\tSuccess: true,\n\t\tMessage: fmt.Sprintf(\"Started task: %s\", task.Title),\n\t}, nil\n}\n\n// UpdateProgress marks milestone progress",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_UpdateProgress_61": {
      "name": "UpdateProgress",
      "type": "method",
      "start_line": 61,
      "end_line": 78,
      "content_hash": "8b0ae831a519bb575d30b679d3cc951dbbdbd383",
      "content": "func (tt *TaskTool) UpdateProgress(ctx context.Context, input AgentTaskInput) (*AgentTaskOutput, error) {\n\tif input.Message == \"\" {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess: false,\n\t\t\tMessage: \"Progress message is required\",\n\t\t}, nil\n\t}\n\n\t// Update task context with progress info\n\ttt.taskService.UpdateTaskContext(ctx, tt.sessionID, input.Message)\n\n\treturn &AgentTaskOutput{\n\t\tSuccess: true,\n\t\tMessage: \"Task context updated\",\n\t}, nil\n}\n\n// CheckDrift monitors for focus drift",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CheckDrift_79": {
      "name": "CheckDrift",
      "type": "method",
      "start_line": 79,
      "end_line": 105,
      "content_hash": "08746ee9c7b5f1aa828b2de88cded33e8b058c47",
      "content": "func (tt *TaskTool) CheckDrift(ctx context.Context, input AgentTaskInput) (*AgentTaskOutput, error) {\n\tif input.Message == \"\" {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess: false,\n\t\t\tMessage: \"Message to analyze is required\",\n\t\t}, nil\n\t}\n\n\tanalysis := tt.taskService.AnalyzeDrift(ctx, tt.sessionID, input.Message)\n\n\tif analysis.Drifted {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess:    true,\n\t\t\tMessage:    \"Drift detected\",\n\t\t\tDriftAlert: true,\n\t\t\tDriftMsg:   strings.Join(analysis.Recommendations, \"; \"),\n\t\t}, nil\n\t}\n\n\treturn &AgentTaskOutput{\n\t\tSuccess:    true,\n\t\tMessage:    \"Focus maintained\",\n\t\tDriftAlert: false,\n\t}, nil\n}\n\n// GetStatus returns current task status",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetStatus_106": {
      "name": "GetStatus",
      "type": "method",
      "start_line": 106,
      "end_line": 123,
      "content_hash": "f19cd89b88b40716b7e9dd2ca42763cd629dec40",
      "content": "func (tt *TaskTool) GetStatus(ctx context.Context, input AgentTaskInput) (*AgentTaskOutput, error) {\n\tsummary := tt.taskService.GetTaskSummary(ctx, tt.sessionID)\n\n\tif summary.Title == \"\" {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess: true,\n\t\t\tMessage: \"No active task\",\n\t\t}, nil\n\t}\n\n\treturn &AgentTaskOutput{\n\t\tSuccess:    true,\n\t\tMessage:    fmt.Sprintf(\"Task: %s (%.0f%% complete)\", summary.Title, summary.Progress*100),\n\t\tTaskStatus: summary,\n\t}, nil\n}\n\n// CompleteTask marks the current task as completed",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CompleteTask_124": {
      "name": "CompleteTask",
      "type": "method",
      "start_line": 124,
      "end_line": 142,
      "content_hash": "0f3a8bf6f5f208a2118ee14177f17427d512a9ea",
      "content": "func (tt *TaskTool) CompleteTask(ctx context.Context, input AgentTaskInput) (*AgentTaskOutput, error) {\n\tsummary := tt.taskService.GetTaskSummary(ctx, tt.sessionID)\n\n\tif summary.Title == \"\" {\n\t\treturn &AgentTaskOutput{\n\t\t\tSuccess: false,\n\t\t\tMessage: \"No active task to complete\",\n\t\t}, nil\n\t}\n\n\ttt.taskService.CompleteTask(ctx, tt.sessionID)\n\n\treturn &AgentTaskOutput{\n\t\tSuccess: true,\n\t\tMessage: fmt.Sprintf(\"Task completed: %s\", summary.Title),\n\t}, nil\n}\n\n// TaskToolSet returns the complete set of task management tools",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_TaskToolSet_143": {
      "name": "TaskToolSet",
      "type": "method",
      "start_line": 143,
      "end_line": 153,
      "content_hash": "5b0b3e49003729c3fcb4b3d30ce47b0936e94392",
      "content": "func (tt *TaskTool) TaskToolSet() map[string]func(context.Context, AgentTaskInput) (*AgentTaskOutput, error) {\n\treturn map[string]func(context.Context, AgentTaskInput) (*AgentTaskOutput, error){\n\t\t\"start_task\":      tt.StartTask,\n\t\t\"update_progress\": tt.UpdateProgress,\n\t\t\"check_drift\":     tt.CheckDrift,\n\t\t\"get_status\":      tt.GetStatus,\n\t\t\"complete_task\":   tt.CompleteTask,\n\t}\n}\n\n// Convert to Cobra CLI commands for testing/admin",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetTaskCommand_154": {
      "name": "GetTaskCommand",
      "type": "method",
      "start_line": 154,
      "end_line": 197,
      "content_hash": "8ef251db486046966bbdcf60c49f6575135d2818",
      "content": "func (tt *TaskTool) GetTaskCommand() *cobra.Command {\n\tcmd := &cobra.Command{\n\t\tUse:   \"task\",\n\t\tShort: \"Manage AI task focus and progress\",\n\t\tLong:  \"Task management tools for keeping AI agents focused and on track\",\n\t}\n\n\t// Status command\n\tstatusCmd := &cobra.Command{\n\t\tUse: \"status\",\n\t\tRun: func(cmd *cobra.Command, args []string) {\n\t\t\toutput, _ := tt.GetStatus(cmd.Context(), AgentTaskInput{})\n\t\t\tif output.Success {\n\t\t\t\tif output.TaskStatus.Title != \"\" {\n\t\t\t\t\tfmt.Printf(\"Task: %s\\n\", output.TaskStatus.Title)\n\t\t\t\t\tfmt.Printf(\"Progress: %.0f%%\\n\", output.TaskStatus.Progress*100)\n\t\t\t\t\tif output.TaskStatus.NextMilestone != nil {\n\t\t\t\t\t\tfmt.Printf(\"Next: %s - %s\\n\", output.TaskStatus.NextMilestone.Title, output.TaskStatus.NextMilestone.Description)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfmt.Println(\"No active task\")\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfmt.Printf(\"Error: %s\\n\", output.Message)\n\t\t\t}\n\t\t},\n\t}\n\n\t// Complete command\n\tcompleteCmd := &cobra.Command{\n\t\tUse: \"complete\",\n\t\tRun: func(cmd *cobra.Command, args []string) {\n\t\t\toutput, _ := tt.CompleteTask(cmd.Context(), AgentTaskInput{})\n\t\t\tif output.Success {\n\t\t\t\tfmt.Println(output.Message)\n\t\t\t} else {\n\t\t\t\tfmt.Printf(\"Error: %s\\n\", output.Message)\n\t\t\t}\n\t\t},\n\t}\n\n\tcmd.AddCommand(statusCmd, completeCmd)\n\treturn cmd\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}