{
  "file_path": "/work/internal/config/model_fallback_test.go",
  "file_hash": "c6ce01aff9a0754b4fea729dde51c7887e269dd1",
  "updated_at": "2025-12-26T17:34:20.231164",
  "symbols": {
    "function_TestModelsNeedSetup_10": {
      "name": "TestModelsNeedSetup",
      "type": "function",
      "start_line": 10,
      "end_line": 24,
      "content_hash": "0ba1fc85359803c12c893aa7f61143a95358a01e",
      "content": "func TestModelsNeedSetup(t *testing.T) {\n\tcfg := &Config{\n\t\tmodelsNeedSetup: true,\n\t}\n\n\tif !cfg.ModelsNeedSetup() {\n\t\tt.Error(\"Expected ModelsNeedSetup to return true\")\n\t}\n\n\tcfg.modelsNeedSetup = false\n\tif cfg.ModelsNeedSetup() {\n\t\tt.Error(\"Expected ModelsNeedSetup to return false\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestValidateModel_25": {
      "name": "TestValidateModel",
      "type": "function",
      "start_line": 25,
      "end_line": 83,
      "content_hash": "a9b1eac1f1bf0dd0de5e8553e8b7acf65b596e31",
      "content": "func TestValidateModel(t *testing.T) {\n\t// Setup config with valid providers\n\tcfg := &Config{\n\t\tProviders: csync.NewMap[string, ProviderConfig](),\n\t}\n\n\tcfg.Providers.Set(\"openai\", ProviderConfig{\n\t\tID:     \"openai\",\n\t\tAPIKey: \"test-key\",\n\t\tModels: []catwalk.Model{\n\t\t\t{ID: \"gpt-4o\", Name: \"GPT-4\"},\n\t\t\t{ID: \"gpt-3.5-turbo\", Name: \"GPT-3.5\"},\n\t\t},\n\t})\n\n\t// Test valid model\n\tcfg.Models = map[SelectedModelType]SelectedModel{\n\t\tSelectedModelTypeLarge: {Provider: \"openai\", Model: \"gpt-4o\"},\n\t}\n\n\tvalid, err := cfg.validateModel(SelectedModelTypeLarge)\n\tif err != nil {\n\t\tt.Fatalf(\"Expected no error, got %v\", err)\n\t}\n\tif !valid {\n\t\tt.Error(\"Expected model to be valid\")\n\t}\n\n\t// Test invalid provider\n\tcfg.Models[SelectedModelTypeLarge] = SelectedModel{Provider: \"invalid\", Model: \"gpt-4o\"}\n\tvalid, err = cfg.validateModel(SelectedModelTypeLarge)\n\tif err != nil {\n\t\tt.Fatalf(\"Expected no error, got %v\", err)\n\t}\n\tif valid {\n\t\tt.Error(\"Expected model with invalid provider to be invalid\")\n\t}\n\n\t// Test invalid model\n\tcfg.Models[SelectedModelTypeLarge] = SelectedModel{Provider: \"openai\", Model: \"invalid-model\"}\n\tvalid, err = cfg.validateModel(SelectedModelTypeLarge)\n\tif err != nil {\n\t\tt.Fatalf(\"Expected no error, got %v\", err)\n\t}\n\tif valid {\n\t\tt.Error(\"Expected invalid model to be invalid\")\n\t}\n\n\t// Test no model selected\n\tdelete(cfg.Models, SelectedModelTypeLarge)\n\tvalid, err = cfg.validateModel(SelectedModelTypeLarge)\n\tif err != nil {\n\t\tt.Fatalf(\"Expected no error, got %v\", err)\n\t}\n\tif valid {\n\t\tt.Error(\"Expected no model to be invalid\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestIsValidRecentModel_84": {
      "name": "TestIsValidRecentModel",
      "type": "function",
      "start_line": 84,
      "end_line": 126,
      "content_hash": "ff298e0bf39e8dcc08630f40c17dd474aad79849",
      "content": "func TestIsValidRecentModel(t *testing.T) {\n\t// Setup config with valid providers\n\tcfg := &Config{\n\t\tProviders: csync.NewMap[string, ProviderConfig](),\n\t}\n\n\tcfg.Providers.Set(\"openai\", ProviderConfig{\n\t\tID:     \"openai\",\n\t\tAPIKey: \"test-key\",\n\t\tModels: []catwalk.Model{\n\t\t\t{ID: \"gpt-4o\", Name: \"GPT-4\"},\n\t\t},\n\t})\n\n\t// Test valid recent model\n\tvalidModel := SelectedModel{Provider: \"openai\", Model: \"gpt-4o\"}\n\tif !cfg.isValidRecentModel(SelectedModelTypeLarge, validModel) {\n\t\tt.Error(\"Expected valid recent model to be valid\")\n\t}\n\n\t// Test invalid provider\n\tinvalidProvider := SelectedModel{Provider: \"invalid\", Model: \"gpt-4o\"}\n\tif cfg.isValidRecentModel(SelectedModelTypeLarge, invalidProvider) {\n\t\tt.Error(\"Expected model with invalid provider to be invalid\")\n\t}\n\n\t// Test invalid model\n\tinvalidModel := SelectedModel{Provider: \"openai\", Model: \"invalid-model\"}\n\tif cfg.isValidRecentModel(SelectedModelTypeLarge, invalidModel) {\n\t\tt.Error(\"Expected invalid model to be invalid\")\n\t}\n\n\t// Test empty values\n\temptyProvider := SelectedModel{Provider: \"\", Model: \"gpt-4o\"}\n\tif cfg.isValidRecentModel(SelectedModelTypeLarge, emptyProvider) {\n\t\tt.Error(\"Expected model with empty provider to be invalid\")\n\t}\n\n\temptyModel := SelectedModel{Provider: \"openai\", Model: \"\"}\n\tif cfg.isValidRecentModel(SelectedModelTypeLarge, emptyModel) {\n\t\tt.Error(\"Expected model with empty model to be invalid\")\n\t}\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}