{
  "file_path": "/work/external-deps/claude-mem/src/services/worker/SettingsManager.ts",
  "file_hash": "6f5434439e139bb0ccafdd3cc8d6a12db4e842dd",
  "updated_at": "2025-12-26T17:34:24.473322",
  "symbols": {
    "class_SettingsManager_14": {
      "name": "SettingsManager",
      "type": "class",
      "start_line": 14,
      "end_line": 68,
      "content_hash": "c985f63c3f1a9c1f69d2ce80eb161e06d308f908",
      "content": "export class SettingsManager {\n  private dbManager: DatabaseManager;\n  private readonly defaultSettings: ViewerSettings = {\n    sidebarOpen: true,\n    selectedProject: null,\n    theme: 'system'\n  };\n\n  constructor(dbManager: DatabaseManager) {\n    this.dbManager = dbManager;\n  }\n\n  /**\n   * Get current viewer settings (with defaults)\n   */\n  getSettings(): ViewerSettings {\n    const db = this.dbManager.getSessionStore().db;\n\n    try {\n      const stmt = db.prepare('SELECT key, value FROM viewer_settings');\n      const rows = stmt.all() as Array<{ key: string; value: string }>;\n\n      const settings: ViewerSettings = { ...this.defaultSettings };\n      for (const row of rows) {\n        const key = row.key as keyof ViewerSettings;\n        if (key in settings) {\n          settings[key] = JSON.parse(row.value) as ViewerSettings[typeof key];\n        }\n      }\n\n      return settings;\n    } catch (error) {\n      logger.debug('WORKER', 'Failed to load settings, using defaults', {}, error as Error);\n      return { ...this.defaultSettings };\n    }\n  }\n\n  /**\n   * Update viewer settings (partial update)\n   */\n  updateSettings(updates: Partial<ViewerSettings>): ViewerSettings {\n    const db = this.dbManager.getSessionStore().db;\n\n    const stmt = db.prepare(`\n      INSERT OR REPLACE INTO viewer_settings (key, value)\n      VALUES (?, ?)\n    `);\n\n    for (const [key, value] of Object.entries(updates)) {\n      stmt.run(key, JSON.stringify(value));\n    }\n\n    return this.getSettings();\n  }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_constructor_22": {
      "name": "constructor",
      "type": "method",
      "start_line": 22,
      "end_line": 24,
      "content_hash": "51881cca1eb9c7b452bb76cee9333b7066487920",
      "content": "  constructor(dbManager: DatabaseManager) {\n    this.dbManager = dbManager;\n  }",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_getSettings_29": {
      "name": "getSettings",
      "type": "method",
      "start_line": 29,
      "end_line": 49,
      "content_hash": "20a64d3046322baf2bc19626067eb0147fc01781",
      "content": "  getSettings(): ViewerSettings {\n    const db = this.dbManager.getSessionStore().db;\n\n    try {\n      const stmt = db.prepare('SELECT key, value FROM viewer_settings');\n      const rows = stmt.all() as Array<{ key: string; value: string }>;\n\n      const settings: ViewerSettings = { ...this.defaultSettings };\n      for (const row of rows) {\n        const key = row.key as keyof ViewerSettings;\n        if (key in settings) {\n          settings[key] = JSON.parse(row.value) as ViewerSettings[typeof key];\n        }\n      }\n\n      return settings;\n    } catch (error) {\n      logger.debug('WORKER', 'Failed to load settings, using defaults', {}, error as Error);\n      return { ...this.defaultSettings };\n    }\n  }",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_updateSettings_54": {
      "name": "updateSettings",
      "type": "method",
      "start_line": 54,
      "end_line": 67,
      "content_hash": "4fac6c971239ff0096771271da03034fa6c30a2c",
      "content": "  updateSettings(updates: Partial<ViewerSettings>): ViewerSettings {\n    const db = this.dbManager.getSessionStore().db;\n\n    const stmt = db.prepare(`\n      INSERT OR REPLACE INTO viewer_settings (key, value)\n      VALUES (?, ?)\n    `);\n\n    for (const [key, value] of Object.entries(updates)) {\n      stmt.run(key, JSON.stringify(value));\n    }\n\n    return this.getSettings();\n  }",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}