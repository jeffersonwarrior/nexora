{
  "file_path": "/work/external-deps/claude-swarm/dist/utils/git-verification.js",
  "file_hash": "5ce33d2138d423a568574a09c3c026d8d08be53a",
  "updated_at": "2025-12-26T17:34:20.561629",
  "symbols": {
    "function_captureGitState_15": {
      "name": "captureGitState",
      "type": "function",
      "start_line": 15,
      "end_line": 26,
      "content_hash": "ca61acace8f696e002641cbae97d285cf342813c",
      "content": "export function captureGitState(projectDir) {\n    try {\n        const hash = execSync(\"git rev-parse HEAD\", {\n            cwd: projectDir,\n            encoding: \"utf-8\",\n        }).trim();\n        return hash;\n    }\n    catch (error) {\n        throw new Error(`Failed to capture git state: ${error instanceof Error ? error.message : String(error)}`);\n    }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_calculateGitVerification_30": {
      "name": "calculateGitVerification",
      "type": "function",
      "start_line": 30,
      "end_line": 89,
      "content_hash": "c2d73b58d7615d7042b3492ddd76037925d19341",
      "content": "export function calculateGitVerification(projectDir, beforeHash, afterHash) {\n    try {\n        // If afterHash not provided, compare beforeHash to current working tree\n        const compareTarget = afterHash || \"HEAD\";\n        // Get diff statistics\n        const diffStat = execSync(`git diff ${beforeHash}${afterHash ? `.${afterHash}` : \"\"} --numstat`, {\n            cwd: projectDir,\n            encoding: \"utf-8\",\n        });\n        // Get list of changed files\n        const filesChanged = execSync(`git diff ${beforeHash}${afterHash ? `.${afterHash}` : \"\"} --name-only`, {\n            cwd: projectDir,\n            encoding: \"utf-8\",\n        })\n            .trim()\n            .split(\"\\n\")\n            .filter((f) => f.length > 0);\n        // Parse numstat output to calculate total lines added/deleted\n        let linesAdded = 0;\n        let linesDeleted = 0;\n        const lines = diffStat.trim().split(\"\\n\");\n        for (const line of lines) {\n            if (!line)\n                continue;\n            const parts = line.split(\"\\t\");\n            if (parts.length < 3)\n                continue;\n            const added = parts[0] === \"-\" ? 0 : parseInt(parts[0], 10);\n            const deleted = parts[1] === \"-\" ? 0 : parseInt(parts[1], 10);\n            linesAdded += added;\n            linesDeleted += deleted;\n        }\n        // Get full diff for checksum\n        const fullDiff = execSync(`git diff ${beforeHash}${afterHash ? `.${afterHash}` : \"\"}`, {\n            cwd: projectDir,\n            encoding: \"utf-8\",\n        });\n        // Calculate SHA-256 checksum of diff\n        const diffChecksum = crypto\n            .createHash(\"sha256\")\n            .update(fullDiff)\n            .digest(\"hex\");\n        // Get current HEAD hash if afterHash not provided\n        const finalAfterHash = afterHash || execSync(\"git rev-parse HEAD\", {\n            cwd: projectDir,\n            encoding: \"utf-8\",\n        }).trim();\n        return {\n            beforeHash,\n            afterHash: finalAfterHash,\n            filesChanged,\n            linesAdded,\n            linesDeleted,\n            diffChecksum,\n        };\n    }\n    catch (error) {\n        throw new Error(`Failed to calculate git verification: ${error instanceof Error ? error.message : String(error)}`);\n    }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_verifyExpectedPackages_94": {
      "name": "verifyExpectedPackages",
      "type": "function",
      "start_line": 94,
      "end_line": 116,
      "content_hash": "089a7025e1867452fea24aaa8a74f43535d2879c",
      "content": "export function verifyExpectedPackages(verification, expectedPackages) {\n    if (!expectedPackages || expectedPackages.length === 0) {\n        return {\n            matched: true,\n            details: \"No package constraints specified\",\n        };\n    }\n    // Check if any changed file is in expected packages\n    const matchedFiles = verification.filesChanged.filter((file) => expectedPackages.some((pkg) => file.startsWith(pkg)));\n    const matched = matchedFiles.length > 0;\n    if (matched) {\n        return {\n            matched: true,\n            details: `${matchedFiles.length}/${verification.filesChanged.length} files match expected packages: ${expectedPackages.join(\", \")}`,\n        };\n    }\n    else {\n        return {\n            matched: false,\n            details: `No files in expected packages. Expected: ${expectedPackages.join(\", \")}. Changed: ${verification.filesChanged.slice(0, 5).join(\", \")}${verification.filesChanged.length > 5 ? \"...\" : \"\"}`,\n        };\n    }\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_formatGitVerification_120": {
      "name": "formatGitVerification",
      "type": "function",
      "start_line": 120,
      "end_line": 140,
      "content_hash": "770e728dbe6a4b6ec66812ce1abb3ad93bdc9a50",
      "content": "export function formatGitVerification(verification) {\n    const lines = [\n        `\ud83d\udcdd Git Verification:`,\n        `   Before: ${verification.beforeHash.slice(0, 8)}`,\n        `   After:  ${verification.afterHash.slice(0, 8)}`,\n        `   Files:  ${verification.filesChanged.length} changed`,\n        `   Lines:  +${verification.linesAdded} -${verification.linesDeleted}`,\n        `   Checksum: ${verification.diffChecksum.slice(0, 16)}...`,\n    ];\n    if (verification.filesChanged.length > 0) {\n        lines.push(`   Changed files:`);\n        const displayFiles = verification.filesChanged.slice(0, 5);\n        for (const file of displayFiles) {\n            lines.push(`     - ${file}`);\n        }\n        if (verification.filesChanged.length > 5) {\n            lines.push(`     ... and ${verification.filesChanged.length - 5} more`);\n        }\n    }\n    return lines.join(\"\\n\");\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}