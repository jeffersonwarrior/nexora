{
  "file_path": "/work/context-engine/tests/test_refrag_phi.py",
  "file_hash": "43f6a74df57bd3258e39ee440ce79b07812f4ae0",
  "updated_at": "2025-12-26T17:34:23.905993",
  "symbols": {
    "function_test_phi_load_and_project_5": {
      "name": "test_phi_load_and_project",
      "type": "function",
      "start_line": 5,
      "end_line": 22,
      "content_hash": "edf0d4f094fd2e7d259e8d252288948cc32593b8",
      "content": "def test_phi_load_and_project(tmp_path):\n    phi = [\n        [1.0, 0.0],\n        [0.0, 2.0],\n        [-1.0, 1.0],\n    ]  # shape (3,2)\n    p = tmp_path / \"phi.json\"\n    p.write_text(json.dumps(phi))\n\n    m = load_phi_matrix(str(p))\n    assert len(m) == 3 and len(m[0]) == 2\n    y = project([2.0, 3.0, 4.0], m)  # [2*1 + 3*0 + 4*(-1), 2*0 + 3*2 + 4*1] = [-2, 10]\n    assert y == [-2.0, 10.0]\n\n    ys = project_batch([[1, 0, 0], [0, 1, 0], [0, 0, 1]], m)\n    assert ys[0] == [1.0, 0.0]\n    assert ys[1] == [0.0, 2.0]\n    assert ys[2] == [-1.0, 1.0]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}