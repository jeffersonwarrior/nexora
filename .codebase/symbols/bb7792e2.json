{
  "file_path": "/work/internal/log/http_test.go",
  "file_hash": "492dacf4fc18ca75a1ec1282e32496151c06b095",
  "updated_at": "2025-12-26T17:34:23.296071",
  "symbols": {
    "function_TestHTTPRoundTripLogger_10": {
      "name": "TestHTTPRoundTripLogger",
      "type": "function",
      "start_line": 10,
      "end_line": 47,
      "content_hash": "5aefe5960fed819fa7c25b760fdf7d54d11bb360",
      "content": "func TestHTTPRoundTripLogger(t *testing.T) {\n\t// Create a test server that returns a 500 error\n\tserver := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\t\tw.Header().Set(\"Content-Type\", \"application/json\")\n\t\tw.Header().Set(\"X-Custom-Header\", \"test-value\")\n\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\tw.Write([]byte(`{\"error\": \"Internal server error\", \"code\": 500}`))\n\t}))\n\tdefer server.Close()\n\n\t// Create HTTP client with logging\n\tclient := NewHTTPClient()\n\n\t// Make a request\n\treq, err := http.NewRequestWithContext(\n\t\tt.Context(),\n\t\thttp.MethodPost,\n\t\tserver.URL,\n\t\tstrings.NewReader(`{\"test\": \"data\"}`),\n\t)\n\tif err != nil {\n\t\tt.Fatal(err)\n\t}\n\treq.Header.Set(\"Content-Type\", \"application/json\")\n\treq.Header.Set(\"Authorization\", \"Bearer secret-token\")\n\n\tresp, err := client.Do(req)\n\tif err != nil {\n\t\tt.Fatal(err)\n\t}\n\tdefer resp.Body.Close()\n\n\t// Verify response\n\tif resp.StatusCode != http.StatusInternalServerError {\n\t\tt.Errorf(\"Expected status code 500, got %d\", resp.StatusCode)\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestFormatHeaders_48": {
      "name": "TestFormatHeaders",
      "type": "function",
      "start_line": 48,
      "end_line": 73,
      "content_hash": "63492be61044e5d56fcbf54a09180081dd21dcda",
      "content": "func TestFormatHeaders(t *testing.T) {\n\theaders := http.Header{\n\t\t\"Content-Type\":  []string{\"application/json\"},\n\t\t\"Authorization\": []string{\"Bearer secret-token\"},\n\t\t\"X-API-Key\":     []string{\"api-key-123\"},\n\t\t\"User-Agent\":    []string{\"test-agent\"},\n\t}\n\n\tformatted := formatHeaders(headers)\n\n\t// Check that sensitive headers are redacted\n\tif formatted[\"Authorization\"][0] != \"[REDACTED]\" {\n\t\tt.Error(\"Authorization header should be redacted\")\n\t}\n\tif formatted[\"X-API-Key\"][0] != \"[REDACTED]\" {\n\t\tt.Error(\"X-API-Key header should be redacted\")\n\t}\n\n\t// Check that non-sensitive headers are preserved\n\tif formatted[\"Content-Type\"][0] != \"application/json\" {\n\t\tt.Error(\"Content-Type header should be preserved\")\n\t}\n\tif formatted[\"User-Agent\"][0] != \"test-agent\" {\n\t\tt.Error(\"User-Agent header should be preserved\")\n\t}\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}