{
  "file_path": "/work/external-deps/Context-Engine/tests/test_service_qdrant_status.py",
  "file_hash": "dee434621e09ef22cebd50f101e7945102566fa9",
  "updated_at": "2025-12-26T17:34:22.957904",
  "symbols": {
    "class_FakeQdrant_8": {
      "name": "FakeQdrant",
      "type": "class",
      "start_line": 8,
      "end_line": 24,
      "content_hash": "edb41804b238a3be160a8af0e0ffd79f330a128d",
      "content": "class FakeQdrant:\n    def __init__(self):\n        self._collections = {\"test\": {\"vectors_count\": 123, \"points_count\": 456}}\n\n    def get_collections(self):\n        return types.SimpleNamespace(collections=[types.SimpleNamespace(name=\"test\")])\n\n    def get_collection(self, collection_name):\n        return types.SimpleNamespace(points_count=456, vectors_count=123)\n\n    def count(self, collection_name, exact=True):\n        return types.SimpleNamespace(count=456)\n\n    def scroll(\n        self, collection_name, limit, offset=None, with_payload=True, with_vectors=False\n    ):\n        return ([], None)",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method___init___9": {
      "name": "__init__",
      "type": "method",
      "start_line": 9,
      "end_line": 10,
      "content_hash": "8668f80ff5282a6c1d6747a787b0053313fdf7d5",
      "content": "    def __init__(self):\n        self._collections = {\"test\": {\"vectors_count\": 123, \"points_count\": 456}}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_get_collections_12": {
      "name": "get_collections",
      "type": "method",
      "start_line": 12,
      "end_line": 13,
      "content_hash": "23d36c4fb7d5776861cfde44377bcbab66db3479",
      "content": "    def get_collections(self):\n        return types.SimpleNamespace(collections=[types.SimpleNamespace(name=\"test\")])",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_get_collection_15": {
      "name": "get_collection",
      "type": "method",
      "start_line": 15,
      "end_line": 16,
      "content_hash": "40479fe0ea82c67d4bdc3cf355a3c255f48a3b15",
      "content": "    def get_collection(self, collection_name):\n        return types.SimpleNamespace(points_count=456, vectors_count=123)",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_count_18": {
      "name": "count",
      "type": "method",
      "start_line": 18,
      "end_line": 19,
      "content_hash": "561754b039fd24b8095d61bed44196faea58f646",
      "content": "    def count(self, collection_name, exact=True):\n        return types.SimpleNamespace(count=456)",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_scroll_21": {
      "name": "scroll",
      "type": "method",
      "start_line": 21,
      "end_line": 24,
      "content_hash": "05dace173d3e590efe607b371663b1577a90d5e0",
      "content": "    def scroll(\n        self, collection_name, limit, offset=None, with_payload=True, with_vectors=False\n    ):\n        return ([], None)",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_qdrant_status_mocked_28": {
      "name": "test_qdrant_status_mocked",
      "type": "function",
      "start_line": 28,
      "end_line": 39,
      "content_hash": "861254c09e874218fb0cf10235a7227fab49972f",
      "content": "def test_qdrant_status_mocked(monkeypatch):\n    # Patch the import site inside the function body by targeting the real module\n    import qdrant_client\n\n    monkeypatch.setattr(qdrant_client, \"QdrantClient\", lambda *a, **k: FakeQdrant())\n\n    out = srv.asyncio.get_event_loop().run_until_complete(\n        srv.qdrant_status(collection=\"test\")\n    )\n    # qdrant_status returns a summary shape without an 'ok' key\n    assert out.get(\"collection\") == \"test\"\n    assert \"count\" in out and \"last_ingested_at\" in out",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}