{
  "file_path": "/work/external-deps/claude-mem/scripts/extraction/extract-all-xml.py",
  "file_hash": "1efe3265494f672e93dfdbb54e96e9a4336ad763",
  "updated_at": "2025-12-26T17:34:23.009460",
  "symbols": {
    "function_extract_xml_blocks_8": {
      "name": "extract_xml_blocks",
      "type": "function",
      "start_line": 8,
      "end_line": 41,
      "content_hash": "7a7f7b4cb80bbe77a05e69b218ff3d82a3055334",
      "content": "def extract_xml_blocks(text):\n    \"\"\"Extract complete XML blocks from text\"\"\"\n    xml_patterns = [\n        r'<observation>.*?</observation>',\n        r'<session_summary>.*?</session_summary>',\n        r'<request>.*?</request>',\n        r'<summary>.*?</summary>',\n        r'<facts>.*?</facts>',\n        r'<fact>.*?</fact>',\n        r'<concepts>.*?</concepts>',\n        r'<concept>.*?</concept>',\n        r'<files>.*?</files>',\n        r'<file>.*?</file>',\n        r'<files_read>.*?</files_read>',\n        r'<files_edited>.*?</files_edited>',\n        r'<files_modified>.*?</files_modified>',\n        r'<narrative>.*?</narrative>',\n        r'<learned>.*?</learned>',\n        r'<investigated>.*?</investigated>',\n        r'<completed>.*?</completed>',\n        r'<next_steps>.*?</next_steps>',\n        r'<notes>.*?</notes>',\n        r'<title>.*?</title>',\n        r'<subtitle>.*?</subtitle>',\n        r'<text>.*?</text>',\n        r'<type>.*?</type>',\n    ]\n\n    blocks = []\n    for pattern in xml_patterns:\n        matches = re.findall(pattern, text, re.DOTALL)\n        blocks.extend(matches)\n\n    return blocks",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_process_transcript_file_43": {
      "name": "process_transcript_file",
      "type": "function",
      "start_line": 43,
      "end_line": 84,
      "content_hash": "a108347de0c8ef99d1ed6f6fad7b5e59a8c34ddc",
      "content": "def process_transcript_file(filepath):\n    \"\"\"Process a single transcript file and extract XML with timestamps\"\"\"\n    results = []\n\n    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:\n        for line in f:\n            try:\n                data = json.loads(line)\n\n                # Get timestamp\n                timestamp = data.get('timestamp', 'unknown')\n\n                # Extract text content from message\n                message = data.get('message', {})\n                content = message.get('content', [])\n\n                if isinstance(content, list):\n                    for item in content:\n                        if isinstance(item, dict):\n                            text = ''\n                            if item.get('type') == 'text':\n                                text = item.get('text', '')\n                            elif item.get('type') == 'tool_use':\n                                # Also check tool_use input fields\n                                tool_input = item.get('input', {})\n                                if isinstance(tool_input, dict):\n                                    text = str(tool_input)\n\n                            if text:\n                                # Extract XML blocks\n                                xml_blocks = extract_xml_blocks(text)\n\n                                for block in xml_blocks:\n                                    results.append({\n                                        'timestamp': timestamp,\n                                        'xml': block\n                                    })\n\n            except json.JSONDecodeError:\n                continue\n\n    return results",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}