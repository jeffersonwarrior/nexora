{
  "file_path": "/work/internal/tui/exp/diffview/udiff_test.go",
  "file_hash": "b65725a440b87d1f5f07a9f3175c3e3f328568a1",
  "updated_at": "2025-12-26T17:34:20.744646",
  "symbols": {
    "function_TestUdiff_12": {
      "name": "TestUdiff",
      "type": "function",
      "start_line": 12,
      "end_line": 18,
      "content_hash": "7886efa4b1d40e2143a888be16861d94e9d278e0",
      "content": "func TestUdiff(t *testing.T) {\n\tbefore := `package main\n\n\timport (\n\t\t\"fmt\"\n\t)\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_main_19": {
      "name": "main",
      "type": "function",
      "start_line": 19,
      "end_line": 28,
      "content_hash": "47770a86cb5e6175bf9df4aa8037a0cb9f80b90d",
      "content": "\tfunc main() {\n\t\tfmt.Println(\"Hello, World!\")\n\t}`\n\n\tafter := `package main\n\n\timport (\n\t\t\"fmt\"\n\t)\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_main_29": {
      "name": "main",
      "type": "function",
      "start_line": 29,
      "end_line": 91,
      "content_hash": "0395d653791eaa6bb8e774c505f35bf7d9a0e5b9",
      "content": "\tfunc main() {\n\t\tcontent := \"Hello, World!\"\n\t\tfmt.Println(content)\n\t}`\n\n\tt.Run(\"Unified\", func(t *testing.T) {\n\t\tcontent := udiff.Unified(\"main.go\", \"main.go\", before, after)\n\t\tgolden.RequireEqual(t, []byte(content))\n\t})\n\n\tt.Run(\"ToUnifiedDiff\", func(t *testing.T) {\n\t\ttoUnifiedDiff := func(t *testing.T, before, after string, contextLines int) udiff.UnifiedDiff {\n\t\t\tedits := udiff.Strings(before, after)\n\t\t\tunifiedDiff, err := udiff.ToUnifiedDiff(\"main.go\", \"main.go\", before, edits, contextLines)\n\t\t\tif err != nil {\n\t\t\t\tt.Fatalf(\"ToUnifiedDiff failed: %v\", err)\n\t\t\t}\n\t\t\treturn unifiedDiff\n\t\t}\n\t\ttoJSON := func(t *testing.T, unifiedDiff udiff.UnifiedDiff) []byte {\n\t\t\tvar buff bytes.Buffer\n\t\t\tencoder := json.NewEncoder(&buff)\n\t\t\tencoder.SetIndent(\"\", \"  \")\n\t\t\tif err := encoder.Encode(unifiedDiff); err != nil {\n\t\t\t\tt.Fatalf(\"Failed to encode unified diff: %v\", err)\n\t\t\t}\n\t\t\treturn buff.Bytes()\n\t\t}\n\n\t\tt.Run(\"DefaultContextLines\", func(t *testing.T) {\n\t\t\tunifiedDiff := toUnifiedDiff(t, before, after, udiff.DefaultContextLines)\n\n\t\t\tt.Run(\"Content\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, []byte(unifiedDiff.String()))\n\t\t\t})\n\t\t\tt.Run(\"JSON\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, toJSON(t, unifiedDiff))\n\t\t\t})\n\t\t})\n\n\t\tt.Run(\"DefaultContextLinesPlusOne\", func(t *testing.T) {\n\t\t\tunifiedDiff := toUnifiedDiff(t, before, after, udiff.DefaultContextLines+1)\n\n\t\t\tt.Run(\"Content\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, []byte(unifiedDiff.String()))\n\t\t\t})\n\t\t\tt.Run(\"JSON\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, toJSON(t, unifiedDiff))\n\t\t\t})\n\t\t})\n\n\t\tt.Run(\"DefaultContextLinesPlusTwo\", func(t *testing.T) {\n\t\t\tunifiedDiff := toUnifiedDiff(t, before, after, udiff.DefaultContextLines+2)\n\n\t\t\tt.Run(\"Content\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, []byte(unifiedDiff.String()))\n\t\t\t})\n\t\t\tt.Run(\"JSON\", func(t *testing.T) {\n\t\t\t\tgolden.RequireEqual(t, toJSON(t, unifiedDiff))\n\t\t\t})\n\t\t})\n\t})\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}