{
  "file_path": "/work/external-deps/helix-db/helix-db/src/helix_gateway/tests/router_tests.rs",
  "file_hash": "7e07d0fafe6f65b106bd22ac63805903b5441d72",
  "updated_at": "2025-12-26T17:34:20.584081",
  "symbols": {
    "function_create_test_graph_15": {
      "name": "create_test_graph",
      "type": "function",
      "start_line": 15,
      "end_line": 25,
      "content_hash": "3d67913393cebfedc195b65cc1e8760f8087f85b",
      "content": "fn create_test_graph() -> (Arc<HelixGraphEngine>, TempDir) {\n    let temp_dir = TempDir::new().unwrap();\n    let opts = HelixGraphEngineOpts {\n        path: temp_dir.path().to_str().unwrap().to_string(),\n        config: Config::default(),\n        version_info: Default::default(),\n    };\n    let graph = Arc::new(HelixGraphEngine::new(opts).unwrap());\n    (graph, temp_dir)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_26": {
      "name": "test_handler",
      "type": "function",
      "start_line": 26,
      "end_line": 32,
      "content_hash": "ef3c05cd18bc3f4b9de82bbb7c47e455539963c4",
      "content": "fn test_handler(_input: HandlerInput) -> Result<Response, GraphError> {\n    Ok(Response {\n        body: b\"test response\".to_vec(),\n        fmt: Format::Json,\n    })\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_error_handler_33": {
      "name": "error_handler",
      "type": "function",
      "start_line": 33,
      "end_line": 36,
      "content_hash": "1e2beef9239bbf4fdb5b693cbe91a79ed82c05c1",
      "content": "fn error_handler(_input: HandlerInput) -> Result<Response, GraphError> {\n    Err(GraphError::New(\"test error\".to_string()))\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_echo_handler_37": {
      "name": "echo_handler",
      "type": "function",
      "start_line": 37,
      "end_line": 48,
      "content_hash": "7239b1aa74b45beaa173ac8d6f051f2e8917c277",
      "content": "fn echo_handler(input: HandlerInput) -> Result<Response, GraphError> {\n    Ok(Response {\n        body: input.request.name.as_bytes().to_vec(),\n        fmt: Format::Json,\n    })\n}\n\n// ============================================================================\n// Router Creation Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_new_empty_49": {
      "name": "test_router_new_empty",
      "type": "function",
      "start_line": 49,
      "end_line": 55,
      "content_hash": "70c9234a6f327816f1211f9d9d5704d66d827c42",
      "content": "fn test_router_new_empty() {\n    let router = HelixRouter::new(None, None, None);\n    assert!(router.routes.is_empty());\n    assert!(router.mcp_routes.is_empty());\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_new_with_routes_56": {
      "name": "test_router_new_with_routes",
      "type": "function",
      "start_line": 56,
      "end_line": 66,
      "content_hash": "97dfcc75f1c2ed8512cdd8f794a766c643e5624a",
      "content": "fn test_router_new_with_routes() {\n    let mut routes = HashMap::new();\n    routes.insert(\"test\".to_string(), Arc::new(test_handler) as HandlerFn);\n\n    let router = HelixRouter::new(Some(routes), None, None);\n    assert_eq!(router.routes.len(), 1);\n    assert!(router.routes.contains_key(\"test\"));\n    assert!(router.mcp_routes.is_empty());\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_new_with_multiple_routes_67": {
      "name": "test_router_new_with_multiple_routes",
      "type": "function",
      "start_line": 67,
      "end_line": 84,
      "content_hash": "b6a6b9159e42e5c7f2a56a2a4ce634ac54d8f801",
      "content": "fn test_router_new_with_multiple_routes() {\n    let mut routes = HashMap::new();\n    routes.insert(\"route1\".to_string(), Arc::new(test_handler) as HandlerFn);\n    routes.insert(\"route2\".to_string(), Arc::new(error_handler) as HandlerFn);\n    routes.insert(\"route3\".to_string(), Arc::new(echo_handler) as HandlerFn);\n\n    let router = HelixRouter::new(Some(routes), None, None);\n    assert_eq!(router.routes.len(), 3);\n    assert!(router.routes.contains_key(\"route1\"));\n    assert!(router.routes.contains_key(\"route2\"));\n    assert!(router.routes.contains_key(\"route3\"));\n}\n\n// ============================================================================\n// Route Addition Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_add_route_85": {
      "name": "test_add_route",
      "type": "function",
      "start_line": 85,
      "end_line": 93,
      "content_hash": "c1d920805e8a1bd92fe2cd44e46fffb025d0636c",
      "content": "fn test_add_route() {\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"test\", test_handler, false);\n\n    assert_eq!(router.routes.len(), 1);\n    assert!(router.routes.contains_key(\"test\"));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_add_multiple_routes_94": {
      "name": "test_add_multiple_routes",
      "type": "function",
      "start_line": 94,
      "end_line": 106,
      "content_hash": "4fe6150b25e4d4d936303ed5be42351f583bb3ce",
      "content": "fn test_add_multiple_routes() {\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"route1\", test_handler, false);\n    router.add_route(\"route2\", error_handler, false);\n    router.add_route(\"route3\", echo_handler, false);\n\n    assert_eq!(router.routes.len(), 3);\n    assert!(router.routes.contains_key(\"route1\"));\n    assert!(router.routes.contains_key(\"route2\"));\n    assert!(router.routes.contains_key(\"route3\"));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_add_route_overwrites_existing_107": {
      "name": "test_add_route_overwrites_existing",
      "type": "function",
      "start_line": 107,
      "end_line": 116,
      "content_hash": "6501e426e385bcdae0d8b7f13ec73c91d8a4701a",
      "content": "fn test_add_route_overwrites_existing() {\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"test\", test_handler, false);\n    router.add_route(\"test\", error_handler, false);\n\n    assert_eq!(router.routes.len(), 1);\n    assert!(router.routes.contains_key(\"test\"));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_add_route_with_special_characters_117": {
      "name": "test_add_route_with_special_characters",
      "type": "function",
      "start_line": 117,
      "end_line": 133,
      "content_hash": "b7ac03a66912a106bb5455446ddf5e4cb40e194f",
      "content": "fn test_add_route_with_special_characters() {\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"/api/v1/query\", test_handler, false);\n    router.add_route(\"user:detail\", test_handler, false);\n    router.add_route(\"test-route\", test_handler, false);\n\n    assert_eq!(router.routes.len(), 3);\n    assert!(router.routes.contains_key(\"/api/v1/query\"));\n    assert!(router.routes.contains_key(\"user:detail\"));\n    assert!(router.routes.contains_key(\"test-route\"));\n}\n\n// ============================================================================\n// Handler Invocation Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_invocation_success_134": {
      "name": "test_handler_invocation_success",
      "type": "function",
      "start_line": 134,
      "end_line": 158,
      "content_hash": "41d0d4ba0d391d715d25cc6a11ad41661a0afbd8",
      "content": "fn test_handler_invocation_success() {\n    let (graph, _temp_dir) = create_test_graph();\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"test\", test_handler, false);\n\n    let handler = router.routes.get(\"test\").unwrap();\n    let input = HandlerInput {\n        request: Request {\n            name: \"test\".to_string(),\n            req_type: RequestType::Query,\n            api_key: None,\n            body: Bytes::new(),\n            in_fmt: Format::Json,\n            out_fmt: Format::Json,\n        },\n        graph: graph.clone(),\n    };\n\n    let result = handler(input);\n    assert!(result.is_ok());\n    let response = result.unwrap();\n    assert_eq!(response.body, b\"test response\");\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_invocation_error_159": {
      "name": "test_handler_invocation_error",
      "type": "function",
      "start_line": 159,
      "end_line": 182,
      "content_hash": "65386dc4e1bb4ceb39cdc0fbe856071b5f12396d",
      "content": "fn test_handler_invocation_error() {\n    let (graph, _temp_dir) = create_test_graph();\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"error\", error_handler, false);\n\n    let handler = router.routes.get(\"error\").unwrap();\n    let input = HandlerInput {\n        request: Request {\n            name: \"error\".to_string(),\n            req_type: RequestType::Query,\n            api_key: None,\n            body: Bytes::new(),\n            in_fmt: Format::Json,\n            out_fmt: Format::Json,\n        },\n        graph: graph.clone(),\n    };\n\n    let result = handler(input);\n    assert!(result.is_err());\n    assert!(result.unwrap_err().to_string().contains(\"test error\"));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_invocation_echo_183": {
      "name": "test_handler_invocation_echo",
      "type": "function",
      "start_line": 183,
      "end_line": 207,
      "content_hash": "d019512a1c872224bc0846f53d86b9e09eff83e8",
      "content": "fn test_handler_invocation_echo() {\n    let (graph, _temp_dir) = create_test_graph();\n    let mut router = HelixRouter::new(None, None, None);\n    router.add_route(\"echo\", echo_handler, false);\n\n    let handler = router.routes.get(\"echo\").unwrap();\n    let input = HandlerInput {\n        request: Request {\n            name: \"test_path\".to_string(),\n            req_type: RequestType::Query,\n            api_key: None,\n            body: Bytes::new(),\n            in_fmt: Format::Json,\n            out_fmt: Format::Json,\n        },\n        graph: graph.clone(),\n    };\n\n    let result = handler(input);\n    assert!(result.is_ok());\n    let response = result.unwrap();\n    assert_eq!(response.body, b\"test_path\");\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_route_not_found_208": {
      "name": "test_route_not_found",
      "type": "function",
      "start_line": 208,
      "end_line": 217,
      "content_hash": "91fbaeb679e6dabc7a4f9b6724180fdb41765874",
      "content": "fn test_route_not_found() {\n    let router = HelixRouter::new(None, None, None);\n    assert!(router.routes.get(\"nonexistent\").is_none());\n}\n\n// ============================================================================\n// Handler Input Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_input_creation_218": {
      "name": "test_handler_input_creation",
      "type": "function",
      "start_line": 218,
      "end_line": 236,
      "content_hash": "9c3061255eb3633a322ae843fcb66f907308ca7b",
      "content": "fn test_handler_input_creation() {\n    let (graph, _temp_dir) = create_test_graph();\n    let input = HandlerInput {\n        request: Request {\n            name: \"test\".to_string(),\n            req_type: RequestType::Query,\n            api_key: None,\n            body: Bytes::new(),\n            in_fmt: Format::Json,\n            out_fmt: Format::Json,\n        },\n        graph: graph.clone(),\n    };\n\n    assert_eq!(input.request.name, \"test\");\n    assert!(input.request.body.is_empty());\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_input_with_body_237": {
      "name": "test_handler_input_with_body",
      "type": "function",
      "start_line": 237,
      "end_line": 260,
      "content_hash": "a34a7177ad43532f9da7ac6551f3e4535d5b4a0f",
      "content": "fn test_handler_input_with_body() {\n    let (graph, _temp_dir) = create_test_graph();\n    let body_data = vec![1, 2, 3, 4];\n    let input = HandlerInput {\n        request: Request {\n            name: \"query\".to_string(),\n            req_type: RequestType::Query,\n            api_key: None,\n            body: Bytes::from(body_data.clone()),\n            in_fmt: Format::Json,\n            out_fmt: Format::Json,\n        },\n        graph: graph.clone(),\n    };\n\n    assert_eq!(input.request.name, \"query\");\n    assert_eq!(input.request.body, Bytes::from(body_data));\n}\n\n// ============================================================================\n// Router Error Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_error_display_261": {
      "name": "test_router_error_display",
      "type": "function",
      "start_line": 261,
      "end_line": 266,
      "content_hash": "aa1dd3376803c9ba8e932da27baa2aa8c3487a22",
      "content": "fn test_router_error_display() {\n    let error = RouterError::New(\"test error message\".to_string());\n    assert_eq!(error.to_string(), \"Graph error: test error message\");\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_error_from_string_267": {
      "name": "test_router_error_from_string",
      "type": "function",
      "start_line": 267,
      "end_line": 272,
      "content_hash": "dcf432ac7e461034f344e8642ee7f6fb7e89026f",
      "content": "fn test_router_error_from_string() {\n    let error: RouterError = \"test error\".to_string().into();\n    assert!(matches!(error, RouterError::New(_)));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_error_to_graph_error_273": {
      "name": "test_router_error_to_graph_error",
      "type": "function",
      "start_line": 273,
      "end_line": 279,
      "content_hash": "bf1ab7851cf93bb06b288e97da83c7d46ae23a7e",
      "content": "fn test_router_error_to_graph_error() {\n    let router_error = RouterError::New(\"router error\".to_string());\n    let graph_error: GraphError = router_error.into();\n    assert!(graph_error.to_string().contains(\"router error\"));\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_graph_error_to_router_error_280": {
      "name": "test_graph_error_to_router_error",
      "type": "function",
      "start_line": 280,
      "end_line": 290,
      "content_hash": "4db983dbd07a40c49cd6befd7e2da194aa2926dd",
      "content": "fn test_graph_error_to_router_error() {\n    let graph_error = GraphError::New(\"graph error\".to_string());\n    let router_error: RouterError = graph_error.into();\n    assert!(router_error.to_string().contains(\"graph error\"));\n}\n\n// ============================================================================\n// Handler Struct Tests\n// ============================================================================\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_creation_291": {
      "name": "test_handler_creation",
      "type": "function",
      "start_line": 291,
      "end_line": 296,
      "content_hash": "fd346c6f60991baa4c9f850a1eec3b0df0894d7f",
      "content": "fn test_handler_creation() {\n    let handler = Handler::new(\"test_handler\", test_handler, false);\n    assert_eq!(handler.name, \"test_handler\");\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_handler_submission_creation_297": {
      "name": "test_handler_submission_creation",
      "type": "function",
      "start_line": 297,
      "end_line": 303,
      "content_hash": "f362dbd4a5872fce2b1fb8bde50dc44111bc7d5c",
      "content": "fn test_handler_submission_creation() {\n    let handler = Handler::new(\"test\", test_handler, false);\n    let submission = HandlerSubmission(handler);\n    assert_eq!(submission.0.name, \"test\");\n}\n\n#[test]",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_test_router_new_with_mcp_routes_304": {
      "name": "test_router_new_with_mcp_routes",
      "type": "function",
      "start_line": 304,
      "end_line": 309,
      "content_hash": "362d0b00ec5b0a63de158ae014a96ef8bf3dd066",
      "content": "fn test_router_new_with_mcp_routes() {\n    let routes = HashMap::new();\n    let router = HelixRouter::new(Some(routes), None, None);\n    assert!(router.routes.is_empty());\n    assert!(router.mcp_routes.is_empty());\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}