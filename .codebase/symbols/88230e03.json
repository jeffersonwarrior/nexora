{
  "file_path": "/work/internal/agent/agent_p1_test.go",
  "file_hash": "b5de89f2e5e9d81553bda7458fc5a58d313f4936",
  "updated_at": "2025-12-26T17:34:22.453898",
  "symbols": {
    "function_TestAgentInitializationP1_7": {
      "name": "TestAgentInitializationP1",
      "type": "function",
      "start_line": 7,
      "end_line": 25,
      "content_hash": "ff66cb5025c1fc932fafaac2dd5c86b2af00bd39",
      "content": "func TestAgentInitializationP1(t *testing.T) {\n\t// Test agent struct creation\n\topts := AgentTestOptions{\n\t\tLargeModel:    \"MiniMax M2.1\",\n\t\tSmallModel:    \"MiniMax M2.1\",\n\t\tSystemPrompt:  \"You are a helpful AI assistant.\",\n\t}\n\t\n\tagent := NewTestAgent(opts)\n\t\n\tif agent == nil {\n\t\tt.Fatal(\"NewTestAgent should return non-nil agent\")\n\t}\n\t\n\tif agent.LargeModel != opts.LargeModel {\n\t\tt.Errorf(\"LargeModel = %s, want %s\", agent.LargeModel, opts.LargeModel)\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestAgentConfigP1_26": {
      "name": "TestAgentConfigP1",
      "type": "function",
      "start_line": 26,
      "end_line": 44,
      "content_hash": "c78fb0bb173bf1d83e3188fb600a0b1f70bc09a4",
      "content": "func TestAgentConfigP1(t *testing.T) {\n\topts := AgentTestOptions{\n\t\tLargeModel:  \"model1\",\n\t\tSmallModel:  \"model2\",\n\t\tMaxTokens:   4096,\n\t\tTemperature: 0.7,\n\t}\n\t\n\tagent := NewTestAgent(opts)\n\t\n\tif agent.GetMaxTokens() != 4096 {\n\t\tt.Errorf(\"MaxTokens = %d, want 4096\", agent.GetMaxTokens())\n\t}\n\t\n\tif agent.GetTemperature() != 0.7 {\n\t\tt.Errorf(\"Temperature = %f, want 0.7\", agent.GetTemperature())\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestToolRegistrationP1_45": {
      "name": "TestToolRegistrationP1",
      "type": "function",
      "start_line": 45,
      "end_line": 71,
      "content_hash": "4d56d32634a9de3b1ef251feeaea73c6bcac53a3",
      "content": "func TestToolRegistrationP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{})\n\t\n\t// Register tools\n\tagent.RegisterTool(\"view\")\n\tagent.RegisterTool(\"edit\")\n\tagent.RegisterTool(\"bash\")\n\t\n\ttools := agent.ListTools()\n\t\n\tif len(tools) != 3 {\n\t\tt.Errorf(\"Expected 3 tools, got %d\", len(tools))\n\t}\n\t\n\tfound := false\n\tfor _, tool := range tools {\n\t\tif tool == \"view\" {\n\t\t\tfound = true\n\t\t\tbreak\n\t\t}\n\t}\n\t\n\tif !found {\n\t\tt.Error(\"Tools should include 'view'\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestMessageHandlingP1_72": {
      "name": "TestMessageHandlingP1",
      "type": "function",
      "start_line": 72,
      "end_line": 92,
      "content_hash": "4071ed1994ca6263993d641139d690b6446f4438",
      "content": "func TestMessageHandlingP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{})\n\t\n\t// Add messages\n\tmsg1 := MessageTest{Role: \"user\", Content: \"Hello\"}\n\tmsg2 := MessageTest{Role: \"assistant\", Content: \"Hi there!\"}\n\t\n\tagent.AddMessage(msg1)\n\tagent.AddMessage(msg2)\n\t\n\tmessages := agent.GetMessages()\n\t\n\tif len(messages) != 2 {\n\t\tt.Errorf(\"Expected 2 messages, got %d\", len(messages))\n\t}\n\t\n\tif messages[0].Role != \"user\" {\n\t\tt.Error(\"First message should be user\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestStateTransitionsP1_93": {
      "name": "TestStateTransitionsP1",
      "type": "function",
      "start_line": 93,
      "end_line": 105,
      "content_hash": "38dcdc5ccf62b0c1211fad262971aa94ae231ee8",
      "content": "func TestStateTransitionsP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{})\n\t\n\tstates := []AgentTestState{TestStateIdle, TestStateThinking, TestStateStreaming, TestStateExecuting, TestStateIdle}\n\t\n\tfor i, expected := range states {\n\t\tagent.SetState(expected)\n\t\tif agent.GetState() != expected {\n\t\t\tt.Errorf(\"State %d = %v, want %v\", i, agent.GetState(), expected)\n\t\t}\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestAgentResetP1_106": {
      "name": "TestAgentResetP1",
      "type": "function",
      "start_line": 106,
      "end_line": 122,
      "content_hash": "efb6f8aea515bc2348e79713e1a858b9f923b273",
      "content": "func TestAgentResetP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{})\n\t\n\tagent.AddMessage(MessageTest{Role: \"user\", Content: \"test\"})\n\tagent.SetState(TestStateThinking)\n\t\n\tagent.Reset()\n\t\n\tif len(agent.GetMessages()) != 0 {\n\t\tt.Error(\"Messages should be empty after reset\")\n\t}\n\t\n\tif agent.GetState() != TestStateIdle {\n\t\tt.Error(\"State should be TestStateIdle after reset\")\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestContextWindowP1_123": {
      "name": "TestContextWindowP1",
      "type": "function",
      "start_line": 123,
      "end_line": 139,
      "content_hash": "612c93dedbf6e70b42f47c42a978b2daeb913902",
      "content": "func TestContextWindowP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{\n\t\tContextWindow: 10,\n\t})\n\t\n\t// Add more than context window messages\n\tfor i := 0; i < 15; i++ {\n\t\tagent.AddMessage(MessageTest{Role: \"user\", Content: \"test\"})\n\t}\n\t\n\tcontext := agent.GetContext()\n\t\n\tif len(context) > 10 {\n\t\tt.Errorf(\"Context should be limited to 10 messages, got %d\", len(context))\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestSystemPromptP1_140": {
      "name": "TestSystemPromptP1",
      "type": "function",
      "start_line": 140,
      "end_line": 150,
      "content_hash": "19305ad9b21abef23940764efae02d284e1c1399",
      "content": "func TestSystemPromptP1(t *testing.T) {\n\tprompt := \"You are a coding assistant.\"\n\tagent := NewTestAgent(AgentTestOptions{\n\t\tSystemPrompt: prompt,\n\t})\n\t\n\tif agent.GetSystemPrompt() != prompt {\n\t\tt.Errorf(\"SystemPrompt = %s, want %s\", agent.GetSystemPrompt(), prompt)\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestModelSelectionP1_151": {
      "name": "TestModelSelectionP1",
      "type": "function",
      "start_line": 151,
      "end_line": 169,
      "content_hash": "591aee63f626d6d377ce5a31a42cf14840181c5f",
      "content": "func TestModelSelectionP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{\n\t\tLargeModel: \"reasoning-model\",\n\t\tSmallModel: \"fast-model\",\n\t})\n\t\n\t// Use reasoning model\n\treasoningModel := agent.SelectModel(true)\n\tif reasoningModel != \"reasoning-model\" {\n\t\tt.Errorf(\"Reasoning model = %s, want reasoning-model\", reasoningModel)\n\t}\n\t\n\t// Use fast model\n\tfastModel := agent.SelectModel(false)\n\tif fastModel != \"fast-model\" {\n\t\tt.Errorf(\"Fast model = %s, want fast-model\", fastModel)\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_TestToolExecutionP1_170": {
      "name": "TestToolExecutionP1",
      "type": "function",
      "start_line": 170,
      "end_line": 185,
      "content_hash": "3c03ac6eb9b3d16f9c778ffc672dc382eb234958",
      "content": "func TestToolExecutionP1(t *testing.T) {\n\tagent := NewTestAgent(AgentTestOptions{})\n\tagent.RegisterTool(\"echo\")\n\t\n\tresult, err := agent.ExecuteTool(\"echo\", map[string]interface{}{\"message\": \"hello\"})\n\t\n\tif err != nil {\n\t\tt.Errorf(\"ExecuteTool failed: %v\", err)\n\t}\n\t\n\tif !result.Success {\n\t\tt.Error(\"Tool execution should succeed\")\n\t}\n}\n\n// Test types (don't conflict with existing types)",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_AgentTestOptions_186": {
      "name": "AgentTestOptions",
      "type": "struct",
      "start_line": 186,
      "end_line": 194,
      "content_hash": "290da7c187b1a9a5ebd7c15f878ea60b2dd6cb55",
      "content": "type AgentTestOptions struct {\n\tLargeModel    string\n\tSmallModel    string\n\tSystemPrompt  string\n\tMaxTokens     int\n\tTemperature   float64\n\tContextWindow int\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_MessageTest_195": {
      "name": "MessageTest",
      "type": "struct",
      "start_line": 195,
      "end_line": 199,
      "content_hash": "614b4b27a857944b6bef48738a37d610c304bb2b",
      "content": "type MessageTest struct {\n\tRole    string\n\tContent string\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_ToolResultTest_200": {
      "name": "ToolResultTest",
      "type": "struct",
      "start_line": 200,
      "end_line": 204,
      "content_hash": "893282766ed24a1c62bcad5bf2dff09ecb20de1a",
      "content": "type ToolResultTest struct {\n\tSuccess bool\n\tOutput  string\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_AgentTest_205": {
      "name": "AgentTest",
      "type": "struct",
      "start_line": 205,
      "end_line": 225,
      "content_hash": "d25772204586ae7968c20e00b9f3e34e9effaee0",
      "content": "type AgentTest struct {\n\tLargeModel    string\n\tSmallModel    string\n\tSystemPrompt  string\n\tMaxTokens     int\n\tTemperature   float64\n\tContextWindow int\n\ttools         map[string]bool\n\tmessages      []MessageTest\n\tstate         AgentTestState\n}\n\ntype AgentTestState int\n\nconst (\n\tTestStateIdle AgentTestState = iota\n\tTestStateThinking\n\tTestStateStreaming\n\tTestStateExecuting\n)\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_NewTestAgent_226": {
      "name": "NewTestAgent",
      "type": "function",
      "start_line": 226,
      "end_line": 239,
      "content_hash": "918d701e122e7dd24b6a34c6925193ba799c28a0",
      "content": "func NewTestAgent(opts AgentTestOptions) *AgentTest {\n\treturn &AgentTest{\n\t\tLargeModel:    opts.LargeModel,\n\t\tSmallModel:    opts.SmallModel,\n\t\tSystemPrompt:  opts.SystemPrompt,\n\t\tMaxTokens:     opts.MaxTokens,\n\t\tTemperature:   opts.Temperature,\n\t\tContextWindow: opts.ContextWindow,\n\t\ttools:         make(map[string]bool),\n\t\tmessages:      []MessageTest{},\n\t\tstate:         TestStateIdle,\n\t}\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetMaxTokens_240": {
      "name": "GetMaxTokens",
      "type": "method",
      "start_line": 240,
      "end_line": 243,
      "content_hash": "544924b0d03d6c4c702a6606b47d9963b11d3e84",
      "content": "func (a *AgentTest) GetMaxTokens() int {\n\treturn a.MaxTokens\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetTemperature_244": {
      "name": "GetTemperature",
      "type": "method",
      "start_line": 244,
      "end_line": 247,
      "content_hash": "f314a9286f1828231d051f3ea23a9287ab7d3838",
      "content": "func (a *AgentTest) GetTemperature() float64 {\n\treturn a.Temperature\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_RegisterTool_248": {
      "name": "RegisterTool",
      "type": "method",
      "start_line": 248,
      "end_line": 251,
      "content_hash": "e5e5eb97e14d25747a9b6c89e8598e169f6cb335",
      "content": "func (a *AgentTest) RegisterTool(name string) {\n\ta.tools[name] = true\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ListTools_252": {
      "name": "ListTools",
      "type": "method",
      "start_line": 252,
      "end_line": 259,
      "content_hash": "b32eb786cb0df85b756b8bf74f194ec578b029a9",
      "content": "func (a *AgentTest) ListTools() []string {\n\tnames := make([]string, 0, len(a.tools))\n\tfor name := range a.tools {\n\t\tnames = append(names, name)\n\t}\n\treturn names\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_AddMessage_260": {
      "name": "AddMessage",
      "type": "method",
      "start_line": 260,
      "end_line": 263,
      "content_hash": "c741650469aaf64580bc7525276578922ac1e96b",
      "content": "func (a *AgentTest) AddMessage(msg MessageTest) {\n\ta.messages = append(a.messages, msg)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetMessages_264": {
      "name": "GetMessages",
      "type": "method",
      "start_line": 264,
      "end_line": 267,
      "content_hash": "1d0b1cd3cc9b167bc59c3c50b607e2bc074db6fa",
      "content": "func (a *AgentTest) GetMessages() []MessageTest {\n\treturn a.messages\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_SetState_268": {
      "name": "SetState",
      "type": "method",
      "start_line": 268,
      "end_line": 271,
      "content_hash": "651f2097b4246c5eab3165a55c966c5c47ca88d5",
      "content": "func (a *AgentTest) SetState(state AgentTestState) {\n\ta.state = state\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetState_272": {
      "name": "GetState",
      "type": "method",
      "start_line": 272,
      "end_line": 275,
      "content_hash": "e685283ab91e47740c888e9c7ba5b7428cfcd790",
      "content": "func (a *AgentTest) GetState() AgentTestState {\n\treturn a.state\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_Reset_276": {
      "name": "Reset",
      "type": "method",
      "start_line": 276,
      "end_line": 280,
      "content_hash": "e2a8a1c424380cd105feffe97955e84841de51b6",
      "content": "func (a *AgentTest) Reset() {\n\ta.messages = []MessageTest{}\n\ta.state = TestStateIdle\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetContext_281": {
      "name": "GetContext",
      "type": "method",
      "start_line": 281,
      "end_line": 287,
      "content_hash": "18656f0d5c4ae5e598cd5a206f44f7ea205fe0f4",
      "content": "func (a *AgentTest) GetContext() []MessageTest {\n\tif len(a.messages) <= a.ContextWindow || a.ContextWindow == 0 {\n\t\treturn a.messages\n\t}\n\treturn a.messages[len(a.messages)-a.ContextWindow:]\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetSystemPrompt_288": {
      "name": "GetSystemPrompt",
      "type": "method",
      "start_line": 288,
      "end_line": 291,
      "content_hash": "f45b458cd4779999554fd05f96c485c7ae641e74",
      "content": "func (a *AgentTest) GetSystemPrompt() string {\n\treturn a.SystemPrompt\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_SelectModel_292": {
      "name": "SelectModel",
      "type": "method",
      "start_line": 292,
      "end_line": 298,
      "content_hash": "18c32cd6d0b99f6f976d7fa3daf7609257f0a1ae",
      "content": "func (a *AgentTest) SelectModel(reasoning bool) string {\n\tif reasoning {\n\t\treturn a.LargeModel\n\t}\n\treturn a.SmallModel\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_ExecuteTool_299": {
      "name": "ExecuteTool",
      "type": "method",
      "start_line": 299,
      "end_line": 301,
      "content_hash": "034dda645e6661975e24174309cdae287a6e45c3",
      "content": "func (a *AgentTest) ExecuteTool(name string, params map[string]interface{}) (*ToolResultTest, error) {\n\treturn &ToolResultTest{Success: true}, nil\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}