{
  "file_path": "/work/internal/task/service.go",
  "file_hash": "a84f44c2840e6fb0646b3c0bc33e3a421b8fc3c5",
  "updated_at": "2025-12-26T17:34:21.182802",
  "symbols": {
    "interface_Service_8": {
      "name": "Service",
      "type": "interface",
      "start_line": 8,
      "end_line": 25,
      "content_hash": "6eee95051a6b6f084d9c5b892e5825c734dd53dd",
      "content": "type Service interface {\n\t// Task lifecycle management\n\tCreateTask(ctx context.Context, sessionID, title, description, context string, milestones []string) *Task\n\tGetActiveTask(ctx context.Context, sessionID string) (*Task, bool)\n\tUpdateTaskContext(ctx context.Context, sessionID, newContext string)\n\tCompleteTask(ctx context.Context, sessionID string)\n\tCloseTask(ctx context.Context, sessionID string)\n\n\t// Drift detection and correction\n\tAnalyzeDrift(ctx context.Context, sessionID, aiResponse string) DriftAnalysis\n\tGetCorrectionPrompt(ctx context.Context, sessionID string) string\n\n\t// Progress tracking\n\tMarkMilestoneProgress(ctx context.Context, sessionID, milestoneID, evidence string)\n\tGetTaskSummary(ctx context.Context, sessionID string) TaskSummary\n}\n\n// TaskSummary provides a concise overview of task state",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_TaskSummary_26": {
      "name": "TaskSummary",
      "type": "struct",
      "start_line": 26,
      "end_line": 36,
      "content_hash": "4e23cab5ab1c61d2281348cece624e4f60a333c0",
      "content": "type TaskSummary struct {\n\tTaskID        string        `json:\"task_id\"`\n\tTitle         string        `json:\"title\"`\n\tStatus        TaskStatus    `json:\"status\"`\n\tProgress      float64       `json:\"progress\"` // 0.0 to 1.0\n\tCurrentPhase  string        `json:\"current_phase\"`\n\tNextMilestone *Milestone    `json:\"next_milestone,omitempty\"`\n\tDriftRisk     DriftAnalysis `json:\"drift_risk,omitempty\"`\n}\n\n// Service implementation",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "struct_taskService_37": {
      "name": "taskService",
      "type": "struct",
      "start_line": 37,
      "end_line": 41,
      "content_hash": "d4c2f77ddc4612e309b3c8537ce4af4f78ce94fd",
      "content": "type taskService struct {\n\tmanager *Manager\n}\n\n// NewService creates a new task service",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "function_NewService_42": {
      "name": "NewService",
      "type": "function",
      "start_line": 42,
      "end_line": 48,
      "content_hash": "b2cca16d7684f67c21418a7e6a7bdab1d0063134",
      "content": "func NewService() Service {\n\treturn &taskService{\n\t\tmanager: NewManager(),\n\t}\n}\n\n// Task lifecycle methods",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CreateTask_49": {
      "name": "CreateTask",
      "type": "method",
      "start_line": 49,
      "end_line": 52,
      "content_hash": "c2b50cdfc75b8cefdd4daa97018e5dea9f4ff1c6",
      "content": "func (s *taskService) CreateTask(ctx context.Context, sessionID, title, description, context string, milestones []string) *Task {\n\treturn s.manager.CreateTask(sessionID, title, description, context, milestones)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetActiveTask_53": {
      "name": "GetActiveTask",
      "type": "method",
      "start_line": 53,
      "end_line": 56,
      "content_hash": "cce676b3ba5ef92ae252a63db0de923c15407426",
      "content": "func (s *taskService) GetActiveTask(ctx context.Context, sessionID string) (*Task, bool) {\n\treturn s.manager.GetTask(sessionID)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_UpdateTaskContext_57": {
      "name": "UpdateTaskContext",
      "type": "method",
      "start_line": 57,
      "end_line": 60,
      "content_hash": "3f1e76b47e02963d4a2876a6e2f300b4742683d3",
      "content": "func (s *taskService) UpdateTaskContext(ctx context.Context, sessionID, newContext string) {\n\ts.manager.UpdateTaskContext(sessionID, newContext)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CompleteTask_61": {
      "name": "CompleteTask",
      "type": "method",
      "start_line": 61,
      "end_line": 64,
      "content_hash": "522412733190a467307c02fc6616a828fa6fddea",
      "content": "func (s *taskService) CompleteTask(ctx context.Context, sessionID string) {\n\ts.manager.CompleteTask(sessionID)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_CloseTask_65": {
      "name": "CloseTask",
      "type": "method",
      "start_line": 65,
      "end_line": 69,
      "content_hash": "bc29aee5baa5b3d2cbd0f54a02beabbe2adebcbe",
      "content": "func (s *taskService) CloseTask(ctx context.Context, sessionID string) {\n\ts.manager.CloseTask(sessionID)\n}\n\n// Drift detection methods",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_AnalyzeDrift_70": {
      "name": "AnalyzeDrift",
      "type": "method",
      "start_line": 70,
      "end_line": 73,
      "content_hash": "5964431bb2feca2d268237095dfbfee1acb35a99",
      "content": "func (s *taskService) AnalyzeDrift(ctx context.Context, sessionID, aiResponse string) DriftAnalysis {\n\treturn s.manager.AnalyzeDrift(sessionID, aiResponse)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetCorrectionPrompt_74": {
      "name": "GetCorrectionPrompt",
      "type": "method",
      "start_line": 74,
      "end_line": 78,
      "content_hash": "54484e460634065a6ff3635d985e61f91c43a759",
      "content": "func (s *taskService) GetCorrectionPrompt(ctx context.Context, sessionID string) string {\n\treturn s.manager.GetCorrectionPrompt(sessionID)\n}\n\n// Progress tracking methods",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_MarkMilestoneProgress_79": {
      "name": "MarkMilestoneProgress",
      "type": "method",
      "start_line": 79,
      "end_line": 82,
      "content_hash": "3ef533af119f44e01ba280c9a43ce54948fb738d",
      "content": "func (s *taskService) MarkMilestoneProgress(ctx context.Context, sessionID, milestoneID, evidence string) {\n\ts.manager.MarkMilestoneProgress(sessionID, milestoneID, evidence)\n}\n",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    },
    "method_GetTaskSummary_83": {
      "name": "GetTaskSummary",
      "type": "method",
      "start_line": 83,
      "end_line": 111,
      "content_hash": "c9341e8c0051b5d30ff2aed1fd57100c82bbf57b",
      "content": "func (s *taskService) GetTaskSummary(ctx context.Context, sessionID string) TaskSummary {\n\ttask, exists := s.manager.GetTask(sessionID)\n\tif !exists {\n\t\treturn TaskSummary{}\n\t}\n\n\tvar completedMilestones int\n\tvar currentMilestone *Milestone\n\n\tfor i, milestone := range task.Milestones {\n\t\tif milestone.Status == StatusCompleted {\n\t\t\tcompletedMilestones++\n\t\t} else if currentMilestone == nil {\n\t\t\tcurrentMilestone = &task.Milestones[i]\n\t\t}\n\t}\n\n\tprogress := float64(completedMilestones) / float64(len(task.Milestones))\n\n\treturn TaskSummary{\n\t\tTaskID:        task.ID,\n\t\tTitle:         task.Title,\n\t\tStatus:        task.Status,\n\t\tProgress:      progress,\n\t\tCurrentPhase:  task.Context,\n\t\tNextMilestone: currentMilestone,\n\t\tDriftRisk:     s.manager.AnalyzeDrift(sessionID, \"\"), // Check for potential drift without analyzing specific response\n\t}\n}",
      "pseudo": "",
      "tags": [],
      "qdrant_ids": []
    }
  }
}